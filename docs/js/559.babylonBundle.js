"use strict";(self.webpackChunkbabylonjs_typescript_webpack_template=self.webpackChunkbabylonjs_typescript_webpack_template||[]).push([[559],{34629:(t,i,e)=>{var s;e.d(i,{N:()=>s}),function(t){t[t.NONE=0]="NONE",t[t.STEP=1]="STEP"}(s||(s={}))},49556:(t,i,e)=>{e.d(i,{X:()=>s});class s{constructor(t,i,e){this.name=t,this.from=i,this.to=e}clone(){return new s(this.name,this.from,this.to)}}},21480:(t,i,e)=>{e.d(i,{o:()=>o});var s=e(50147),a=e(46461),n=e(7786);class o{constructor(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this.targetAlpha=null,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}get name(){return"AutoRotation"}set zoomStopsAnimation(t){this._zoomStopsAnimation=t}get zoomStopsAnimation(){return this._zoomStopsAnimation}set idleRotationSpeed(t){this._idleRotationSpeed=t}get idleRotationSpeed(){return this._idleRotationSpeed}set idleRotationWaitTime(t){this._idleRotationWaitTime=t}get idleRotationWaitTime(){return this._idleRotationWaitTime}set idleRotationSpinupTime(t){this._idleRotationSpinupTime=t}get idleRotationSpinupTime(){return this._idleRotationSpinupTime}get rotationInProgress(){return Math.abs(this._cameraRotationSpeed)>0}init(){}attach(t){this._attachedCamera=t;const i=this._attachedCamera.getScene();this._onPrePointerObservableObserver=i.onPrePointerObservable.add((t=>{t.type!==s.kD.POINTERDOWN?t.type===s.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{if(this._reachTargetAlpha())return;const t=a.F.Now;let i=0;null!=this._lastFrameTime&&(i=t-this._lastFrameTime),this._lastFrameTime=t,this._applyUserInteraction();const e=t-this._lastInteractionTime-this._idleRotationWaitTime,s=Math.max(Math.min(e/this._idleRotationSpinupTime,1),0);this._cameraRotationSpeed=this._idleRotationSpeed*s,this._attachedCamera&&(this._attachedCamera.alpha-=this._cameraRotationSpeed*(i/1e3))}))}detach(){if(!this._attachedCamera)return;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}resetLastInteractionTime(t){this._lastInteractionTime=null!=t?t:a.F.Now}_reachTargetAlpha(){return!(!this._attachedCamera||!this.targetAlpha)&&Math.abs(this._attachedCamera.alpha-this.targetAlpha)<n.kn}_userIsZooming(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset}_shouldAnimationStopForInteraction(){if(!this._attachedCamera)return!1;let t=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(t=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?t:this._userIsZooming()}_applyUserInteraction(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=a.F.Now)}_userIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}},63425:(t,i,e)=>{e.d(i,{r:()=>n});var s=e(49011),a=e(83427);class n{constructor(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}get name(){return"Bouncing"}get autoTransitionRange(){return this._autoTransitionRange}set autoTransitionRange(t){if(this._autoTransitionRange===t)return;this._autoTransitionRange=t;const i=this._attachedCamera;i&&(t?this._onMeshTargetChangedObserver=i.onMeshTargetChangedObservable.add((t=>{if(!t)return;t.computeWorldMatrix(!0);const i=t.getBoundingInfo().diagonalLength;this.lowerRadiusTransitionRange=.05*i,this.upperRadiusTransitionRange=.05*i})):this._onMeshTargetChangedObserver&&i.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}init(){}attach(t){this._attachedCamera=t,this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{this._attachedCamera&&(this._isRadiusAtLimit(this._attachedCamera.lowerRadiusLimit)&&this._applyBoundRadiusAnimation(this.lowerRadiusTransitionRange),this._isRadiusAtLimit(this._attachedCamera.upperRadiusLimit)&&this._applyBoundRadiusAnimation(this.upperRadiusTransitionRange))}))}detach(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)}_isRadiusAtLimit(t){return!!this._attachedCamera&&this._attachedCamera.radius===t&&!this._radiusIsAnimating}_applyBoundRadiusAnimation(t){if(!this._attachedCamera)return;this._radiusBounceTransition||(n.EasingFunction.setEasingMode(n.EasingMode),this._radiusBounceTransition=a.f.CreateAnimation("radius",a.f.ANIMATIONTYPE_FLOAT,60,n.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;const i=a.f.TransitionTo("radius",this._attachedCamera.radius+t,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,(()=>this._clearAnimationLocks()));i&&this._animatables.push(i)}_clearAnimationLocks(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()}}n.EasingFunction=new s.ud(.3),n.EasingMode=s.Kp.EASINGMODE_EASEOUT},11193:(t,i,e)=>{e.d(i,{d:()=>l});var s=e(49011),a=e(64673),n=e(50147),o=e(46461),r=e(90972),h=e(83427);class l{constructor(){this.onTargetFramingAnimationEndObservable=new a.y$,this._mode=l.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}get name(){return"Framing"}set mode(t){this._mode=t}get mode(){return this._mode}set radiusScale(t){this._radiusScale=t}get radiusScale(){return this._radiusScale}set positionScale(t){this._positionScale=t}get positionScale(){return this._positionScale}set defaultElevation(t){this._defaultElevation=t}get defaultElevation(){return this._defaultElevation}set elevationReturnTime(t){this._elevationReturnTime=t}get elevationReturnTime(){return this._elevationReturnTime}set elevationReturnWaitTime(t){this._elevationReturnWaitTime=t}get elevationReturnWaitTime(){return this._elevationReturnWaitTime}set zoomStopsAnimation(t){this._zoomStopsAnimation=t}get zoomStopsAnimation(){return this._zoomStopsAnimation}set framingTime(t){this._framingTime=t}get framingTime(){return this._framingTime}init(){}attach(t){this._attachedCamera=t;const i=this._attachedCamera.getScene();l.EasingFunction.setEasingMode(l.EasingMode),this._onPrePointerObservableObserver=i.onPrePointerObservable.add((t=>{t.type!==n.kD.POINTERDOWN?t.type===n.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onMeshTargetChangedObserver=t.onMeshTargetChangedObservable.add((t=>{t&&this.zoomOnMesh(t,void 0,(()=>{this.onTargetFramingAnimationEndObservable.notifyObservers()}))})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{this._applyUserInteraction(),this._maintainCameraAboveGround()}))}detach(){if(!this._attachedCamera)return;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}zoomOnMesh(t,i=!1,e=null){t.computeWorldMatrix(!0);const s=t.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(s.minimumWorld,s.maximumWorld,i,e)}zoomOnMeshHierarchy(t,i=!1,e=null){t.computeWorldMatrix(!0);const s=t.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(s.min,s.max,i,e)}zoomOnMeshesHierarchy(t,i=!1,e=null){const s=new r.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let i=0;i<t.length;i++){const e=t[i].getHierarchyBoundingVectors(!0);r.P.CheckExtends(e.min,s,a),r.P.CheckExtends(e.max,s,a)}this.zoomOnBoundingInfo(s,a,i,e)}zoomOnBoundingInfo(t,i,e=!1,s=null){let a;if(!this._attachedCamera)return!1;const n=t.y,o=n+(i.y-n)*this._positionScale,c=i.subtract(t).scale(.5);if(e)a=new r.P(0,o,0);else{const i=t.add(c);a=new r.P(i.x,o,i.z)}this._vectorTransition||(this._vectorTransition=h.f.CreateAnimation("target",h.f.ANIMATIONTYPE_VECTOR3,60,l.EasingFunction)),this._betaIsAnimating=!0;let u=h.f.TransitionTo("target",a,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);u&&this._animatables.push(u);let d=0;if(this._mode===l.FitFrustumSidesMode){const e=this._calculateLowerRadiusFromModelBoundingSphere(t,i);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=c.length()+this._attachedCamera.minZ),d=e}else this._mode===l.IgnoreBoundsSizeMode&&(d=this._calculateLowerRadiusFromModelBoundingSphere(t,i),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){const e=i.subtract(t).length();this._attachedCamera.panningSensibility=5e3/e,this._attachedCamera.wheelPrecision=100/d}return this._radiusTransition||(this._radiusTransition=h.f.CreateAnimation("radius",h.f.ANIMATIONTYPE_FLOAT,60,l.EasingFunction)),u=h.f.TransitionTo("radius",d,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,(()=>{this.stopAllAnimations(),s&&s(),this._attachedCamera&&this._attachedCamera.useInputToRestoreState&&this._attachedCamera.storeState()})),u&&this._animatables.push(u),!0}_calculateLowerRadiusFromModelBoundingSphere(t,i){const e=i.subtract(t).length(),s=this._getFrustumSlope(),a=.5*e*this._radiusScale,n=a*Math.sqrt(1+1/(s.x*s.x)),o=a*Math.sqrt(1+1/(s.y*s.y));let r=Math.max(n,o);const h=this._attachedCamera;return h?(h.lowerRadiusLimit&&this._mode===l.IgnoreBoundsSizeMode&&(r=r<h.lowerRadiusLimit?h.lowerRadiusLimit:r),h.upperRadiusLimit&&(r=r>h.upperRadiusLimit?h.upperRadiusLimit:r),r):0}_maintainCameraAboveGround(){if(this._elevationReturnTime<0)return;const t=o.F.Now-this._lastInteractionTime,i=.5*Math.PI-this._defaultElevation,e=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>e&&t>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=h.f.CreateAnimation("beta",h.f.ANIMATIONTYPE_FLOAT,60,l.EasingFunction));const t=h.f.TransitionTo("beta",i,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,(()=>{this._clearAnimationLocks(),this.stopAllAnimations()}));t&&this._animatables.push(t)}}_getFrustumSlope(){const t=this._attachedCamera;if(!t)return r.FM.Zero();const i=t.getScene().getEngine().getAspectRatio(t),e=Math.tan(t.fov/2),s=e*i;return new r.FM(s,e)}_clearAnimationLocks(){this._betaIsAnimating=!1}_applyUserInteraction(){this.isUserIsMoving&&(this._lastInteractionTime=o.F.Now,this.stopAllAnimations(),this._clearAnimationLocks())}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()}get isUserIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}l.EasingFunction=new s.EI,l.EasingMode=s.Kp.EASINGMODE_EASEINOUT,l.IgnoreBoundsSizeMode=0,l.FitFrustumSidesMode=1},7632:(t,i,e)=>{e.d(i,{O:()=>r});var s=e(13555),a=e(96786),n=e(14651),o=e(50147);class r{constructor(){this._currentActiveButton=-1,this.buttons=[0,1,2]}attachControl(t){t=n.w1.BackCompatCameraNoPreventDefault(arguments);const i=this.camera.getEngine(),e=i.getInputElement();let s=0,a=null;this._pointA=null,this._pointB=null,this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._pointerInput=n=>{var r,h;const l=n.event,c="touch"===l.pointerType;if(i.isInVRExclusivePointerMode)return;if(n.type!==o.kD.POINTERMOVE&&-1===this.buttons.indexOf(l.button))return;const u=l.target;if(this._altKey=l.altKey,this._ctrlKey=l.ctrlKey,this._metaKey=l.metaKey,this._shiftKey=l.shiftKey,this._buttonsPressed=l.buttons,i.isPointerLock){const t=l.movementX,i=l.movementY;this.onTouch(null,t,i),this._pointA=null,this._pointB=null}else{if(n.type!==o.kD.POINTERDOWN&&c&&(null===(r=this._pointA)||void 0===r?void 0:r.pointerId)!==l.pointerId&&(null===(h=this._pointB)||void 0===h?void 0:h.pointerId)!==l.pointerId)return;if(n.type!==o.kD.POINTERDOWN||-1!==this._currentActiveButton&&!c)if(n.type===o.kD.POINTERDOUBLETAP)this.onDoubleTap(l.pointerType);else if(n.type!==o.kD.POINTERUP||this._currentActiveButton!==l.button&&!c){if(n.type===o.kD.POINTERMOVE)if(t||l.preventDefault(),this._pointA&&null===this._pointB){const t=l.clientX-this._pointA.x,i=l.clientY-this._pointA.y;this.onTouch(this._pointA,t,i),this._pointA.x=l.clientX,this._pointA.y=l.clientY}else if(this._pointA&&this._pointB){const t=this._pointA.pointerId===l.pointerId?this._pointA:this._pointB;t.x=l.clientX,t.y=l.clientY;const i=this._pointA.x-this._pointB.x,e=this._pointA.y-this._pointB.y,o=i*i+e*e,r={x:(this._pointA.x+this._pointB.x)/2,y:(this._pointA.y+this._pointB.y)/2,pointerId:l.pointerId,type:n.type};this.onMultiTouch(this._pointA,this._pointB,s,o,a,r),a=r,s=o}}else{try{null==u||u.releasePointerCapture(l.pointerId)}catch(t){}c||(this._pointB=null),i._badOS?this._pointA=this._pointB=null:this._pointB&&this._pointA&&this._pointA.pointerId==l.pointerId?(this._pointA=this._pointB,this._pointB=null):this._pointA&&this._pointB&&this._pointB.pointerId==l.pointerId?this._pointB=null:this._pointA=this._pointB=null,(0!==s||a)&&(this.onMultiTouch(this._pointA,this._pointB,s,0,a,null),s=0,a=null),this._currentActiveButton=-1,this.onButtonUp(l),t||l.preventDefault()}else{try{null==u||u.setPointerCapture(l.pointerId)}catch(t){}if(null===this._pointA)this._pointA={x:l.clientX,y:l.clientY,pointerId:l.pointerId,type:l.pointerType};else{if(null!==this._pointB)return;this._pointB={x:l.clientX,y:l.clientY,pointerId:l.pointerId,type:l.pointerType}}-1!==this._currentActiveButton||c||(this._currentActiveButton=l.button),this.onButtonDown(l),t||(l.preventDefault(),e&&e.focus())}}},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,o.kD.POINTERDOWN|o.kD.POINTERUP|o.kD.POINTERMOVE|o.kD.POINTERDOUBLETAP),this._onLostFocus=()=>{this._pointA=this._pointB=null,s=0,a=null,this.onLostFocus()},this._contextMenuBind=this.onContextMenu.bind(this),e&&e.addEventListener("contextmenu",this._contextMenuBind,!1);const r=this.camera.getScene().getEngine().getHostWindow();r&&n.w1.RegisterTopRootEvents(r,[{name:"blur",handler:this._onLostFocus}])}detachControl(){if(this._onLostFocus){const t=this.camera.getScene().getEngine().getHostWindow();t&&n.w1.UnregisterTopRootEvents(t,[{name:"blur",handler:this._onLostFocus}])}if(this._observer){if(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._contextMenuBind){const t=this.camera.getScene().getEngine().getInputElement();t&&t.removeEventListener("contextmenu",this._contextMenuBind)}this._onLostFocus=null}this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._currentActiveButton=-1}getClassName(){return"BaseCameraPointersInput"}getSimpleName(){return"pointers"}onDoubleTap(t){}onTouch(t,i,e){}onMultiTouch(t,i,e,s,a,n){}onContextMenu(t){t.preventDefault()}onButtonDown(t){}onButtonUp(t){}onLostFocus(){}}(0,s.gn)([(0,a.qC)()],r.prototype,"buttons",void 0)},34452:(t,i,e)=>{e.d(i,{v:()=>h});var s=e(13555),a=e(96786),n=e(4442),o=e(26233),r=e(14651);class h{constructor(){this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}attachControl(t){t=r.w1.BackCompatCameraNoPreventDefault(arguments),this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add((()=>{this._keys.length=0})),this._onKeyboardObserver=this._scene.onKeyboardObservable.add((i=>{const e=i.event;if(!e.metaKey)if(i.type===o.OG.KEYDOWN)this._ctrlPressed=e.ctrlKey,this._altPressed=e.altKey,(-1!==this.keysUp.indexOf(e.keyCode)||-1!==this.keysDown.indexOf(e.keyCode)||-1!==this.keysLeft.indexOf(e.keyCode)||-1!==this.keysRight.indexOf(e.keyCode)||-1!==this.keysReset.indexOf(e.keyCode))&&(-1===this._keys.indexOf(e.keyCode)&&this._keys.push(e.keyCode),e.preventDefault&&(t||e.preventDefault()));else if(-1!==this.keysUp.indexOf(e.keyCode)||-1!==this.keysDown.indexOf(e.keyCode)||-1!==this.keysLeft.indexOf(e.keyCode)||-1!==this.keysRight.indexOf(e.keyCode)||-1!==this.keysReset.indexOf(e.keyCode)){const i=this._keys.indexOf(e.keyCode);i>=0&&this._keys.splice(i,1),e.preventDefault&&(t||e.preventDefault())}})))}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}checkInputs(){if(this._onKeyboardObserver){const t=this.camera;for(let i=0;i<this._keys.length;i++){const e=this._keys[i];-1!==this.keysLeft.indexOf(e)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX-=1/this.panningSensibility:t.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(e)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset+=1/this.zoomingSensibility:t.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(e)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX+=1/this.panningSensibility:t.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(e)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset-=1/this.zoomingSensibility:t.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(e)&&t.useInputToRestoreState&&t.restoreState()}}}getClassName(){return"ArcRotateCameraKeyboardMoveInput"}getSimpleName(){return"keyboard"}}(0,s.gn)([(0,a.qC)()],h.prototype,"keysUp",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"keysDown",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"keysLeft",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"keysRight",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"keysReset",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"panningSensibility",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"zoomingSensibility",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"useAltToZoom",void 0),(0,s.gn)([(0,a.qC)()],h.prototype,"angularSpeed",void 0),n.u.ArcRotateCameraKeyboardMoveInput=h},17366:(t,i,e)=>{e.d(i,{F:()=>p});var s=e(13555),a=e(96786),n=e(4442),o=e(50147),r=e(8329),h=e(90972),l=e(7786),c=e(96485),u=e(31865),d=e(14651);class p{constructor(){this.wheelPrecision=3,this.zoomToMouseLocation=!1,this.wheelDeltaPercentage=0,this.customComputeDeltaFromMouseWheel=null,this._viewOffset=new h.P(0,0,0),this._globalOffset=new h.P(0,0,0),this._inertialPanning=h.P.Zero()}_computeDeltaFromMouseWheelLegacyEvent(t,i){let e=0;const s=.01*t*this.wheelDeltaPercentage*i;return e=t>0?s/(1+this.wheelDeltaPercentage):s*(1+this.wheelDeltaPercentage),e}attachControl(t){t=d.w1.BackCompatCameraNoPreventDefault(arguments),this._wheel=i=>{if(i.type!==o.kD.POINTERWHEEL)return;const e=i.event;let s=0;const a=e.deltaMode===c.G.DOM_DELTA_LINE?40:1,n=-e.deltaY*a;if(this.customComputeDeltaFromMouseWheel)s=this.customComputeDeltaFromMouseWheel(n,this,e);else if(this.wheelDeltaPercentage){if(s=this._computeDeltaFromMouseWheelLegacyEvent(n,this.camera.radius),s>0){let t=this.camera.radius,i=this.camera.inertialRadiusOffset+s;for(let e=0;e<20&&Math.abs(i)>.001;e++)t-=i,i*=this.camera.inertia;t=u.R.Clamp(t,0,Number.MAX_VALUE),s=this._computeDeltaFromMouseWheelLegacyEvent(n,t)}}else s=n/(40*this.wheelPrecision);s&&(this.zoomToMouseLocation?(this._hitPlane||this._updateHitPlane(),this._zoomToMouse(s)):this.camera.inertialRadiusOffset+=s),e.preventDefault&&(t||e.preventDefault())},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._wheel,o.kD.POINTERWHEEL),this.zoomToMouseLocation&&this._inertialPanning.setAll(0)}detachControl(){this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._wheel=null)}checkInputs(){if(!this.zoomToMouseLocation)return;const t=this.camera;0+t.inertialAlphaOffset+t.inertialBetaOffset+t.inertialRadiusOffset&&(this._updateHitPlane(),t.target.addInPlace(this._inertialPanning),this._inertialPanning.scaleInPlace(t.inertia),this._zeroIfClose(this._inertialPanning))}getClassName(){return"ArcRotateCameraMouseWheelInput"}getSimpleName(){return"mousewheel"}_updateHitPlane(){const t=this.camera,i=t.target.subtract(t.position);this._hitPlane=r.J.FromPositionAndNormal(t.target,i)}_getPosition(){var t;const i=this.camera,e=i.getScene(),s=e.createPickingRay(e.pointerX,e.pointerY,h.y3.Identity(),i,!1);0===i.targetScreenOffset.x&&0===i.targetScreenOffset.y||(this._viewOffset.set(i.targetScreenOffset.x,i.targetScreenOffset.y,0),i.getViewMatrix().invertToRef(i._cameraTransformMatrix),this._globalOffset=h.P.TransformNormal(this._viewOffset,i._cameraTransformMatrix),s.origin.addInPlace(this._globalOffset));let a=0;return this._hitPlane&&(a=null!==(t=s.intersectsPlane(this._hitPlane))&&void 0!==t?t:0),s.origin.addInPlace(s.direction.scaleInPlace(a))}_zoomToMouse(t){var i,e;const s=this.camera,a=1-s.inertia;if(s.lowerRadiusLimit){const e=null!==(i=s.lowerRadiusLimit)&&void 0!==i?i:0;s.radius-(s.inertialRadiusOffset+t)/a<e&&(t=(s.radius-e)*a-s.inertialRadiusOffset)}if(s.upperRadiusLimit){const i=null!==(e=s.upperRadiusLimit)&&void 0!==e?e:0;s.radius-(s.inertialRadiusOffset+t)/a>i&&(t=(s.radius-i)*a-s.inertialRadiusOffset)}const n=t/a/s.radius,o=this._getPosition(),r=h.jp.Vector3[6];o.subtractToRef(s.target,r),r.scaleInPlace(n),r.scaleInPlace(a),this._inertialPanning.addInPlace(r),s.inertialRadiusOffset+=t}_zeroIfClose(t){Math.abs(t.x)<l.kn&&(t.x=0),Math.abs(t.y)<l.kn&&(t.y=0),Math.abs(t.z)<l.kn&&(t.z=0)}}(0,s.gn)([(0,a.qC)()],p.prototype,"wheelPrecision",void 0),(0,s.gn)([(0,a.qC)()],p.prototype,"zoomToMouseLocation",void 0),(0,s.gn)([(0,a.qC)()],p.prototype,"wheelDeltaPercentage",void 0),n.u.ArcRotateCameraMouseWheelInput=p},55630:(t,i,e)=>{e.d(i,{H:()=>r});var s=e(13555),a=e(96786),n=e(4442),o=e(7632);class r extends o.O{constructor(){super(...arguments),this.buttons=[0,1,2],this.angularSensibilityX=1e3,this.angularSensibilityY=1e3,this.pinchPrecision=12,this.pinchDeltaPercentage=0,this.useNaturalPinchZoom=!1,this.pinchZoom=!0,this.panningSensibility=1e3,this.multiTouchPanning=!0,this.multiTouchPanAndZoom=!0,this.pinchInwards=!0,this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}getClassName(){return"ArcRotateCameraPointersInput"}_computeMultiTouchPanning(t,i){if(0!==this.panningSensibility&&t&&i){const e=i.x-t.x,s=i.y-t.y;this.camera.inertialPanningX+=-e/this.panningSensibility,this.camera.inertialPanningY+=s/this.panningSensibility}}_computePinchZoom(t,i){const e=this.camera.radius||r.MinimumRadiusForPinch;this.useNaturalPinchZoom?this.camera.radius=e*Math.sqrt(t)/Math.sqrt(i):this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=.001*(i-t)*e*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(i-t)/(this.pinchPrecision*(this.pinchInwards?1:-1)*(this.angularSensibilityX+this.angularSensibilityY)/2)}onTouch(t,i,e){0!==this.panningSensibility&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-i/this.panningSensibility,this.camera.inertialPanningY+=e/this.panningSensibility):(this.camera.inertialAlphaOffset-=i/this.angularSensibilityX,this.camera.inertialBetaOffset-=e/this.angularSensibilityY)}onDoubleTap(){this.camera.useInputToRestoreState&&this.camera.restoreState()}onMultiTouch(t,i,e,s,a,n){0===e&&null===a||0===s&&null===n||(this.multiTouchPanAndZoom?(this._computePinchZoom(e,s),this._computeMultiTouchPanning(a,n)):this.multiTouchPanning&&this.pinchZoom?(this._twoFingerActivityCount++,this._isPinching||this._twoFingerActivityCount<20&&Math.abs(Math.sqrt(s)-Math.sqrt(e))>this.camera.pinchToPanMaxDistance?(this._computePinchZoom(e,s),this._isPinching=!0):this._computeMultiTouchPanning(a,n)):this.multiTouchPanning?this._computeMultiTouchPanning(a,n):this.pinchZoom&&this._computePinchZoom(e,s))}onButtonDown(t){this._isPanClick=t.button===this.camera._panningMouseButton}onButtonUp(t){this._twoFingerActivityCount=0,this._isPinching=!1}onLostFocus(){this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}}r.MinimumRadiusForPinch=.001,(0,s.gn)([(0,a.qC)()],r.prototype,"buttons",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"angularSensibilityX",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"angularSensibilityY",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"pinchPrecision",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"pinchDeltaPercentage",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"useNaturalPinchZoom",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"pinchZoom",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"panningSensibility",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"multiTouchPanning",void 0),(0,s.gn)([(0,a.qC)()],r.prototype,"multiTouchPanAndZoom",void 0),n.u.ArcRotateCameraPointersInput=r},23579:(t,i,e)=>{e.d(i,{Y:()=>f});var s=e(13555),a=e(96786),n=e(64673),o=e(90972),r=e(62528),h=e(33632),l=e(21480),c=e(63425),u=e(11193),d=e(95593),p=e(35753),_=e(54946),m=e(7786),g=e(14651);r.N.AddNodeConstructor("ArcRotateCamera",((t,i)=>()=>new f(t,0,0,1,o.P.Zero(),i)));class f extends p.C{get target(){return this._target}set target(t){this.setTarget(t)}get targetHost(){return this._targetHost}set targetHost(t){t&&this.setTarget(t)}getTarget(){return this.target}get position(){return this._position}set position(t){this.setPosition(t)}set upVector(t){this._upToYMatrix||(this._yToUpMatrix=new o.y3,this._upToYMatrix=new o.y3,this._upVector=o.P.Zero()),t.normalize(),this._upVector.copyFrom(t),this.setMatUp()}get upVector(){return this._upVector}setMatUp(){o.y3.RotationAlignToRef(o.P.UpReadOnly,this._upVector,this._yToUpMatrix),o.y3.RotationAlignToRef(this._upVector,o.P.UpReadOnly,this._upToYMatrix)}get angularSensibilityX(){const t=this.inputs.attached.pointers;return t?t.angularSensibilityX:0}set angularSensibilityX(t){const i=this.inputs.attached.pointers;i&&(i.angularSensibilityX=t)}get angularSensibilityY(){const t=this.inputs.attached.pointers;return t?t.angularSensibilityY:0}set angularSensibilityY(t){const i=this.inputs.attached.pointers;i&&(i.angularSensibilityY=t)}get pinchPrecision(){const t=this.inputs.attached.pointers;return t?t.pinchPrecision:0}set pinchPrecision(t){const i=this.inputs.attached.pointers;i&&(i.pinchPrecision=t)}get pinchDeltaPercentage(){const t=this.inputs.attached.pointers;return t?t.pinchDeltaPercentage:0}set pinchDeltaPercentage(t){const i=this.inputs.attached.pointers;i&&(i.pinchDeltaPercentage=t)}get useNaturalPinchZoom(){const t=this.inputs.attached.pointers;return!!t&&t.useNaturalPinchZoom}set useNaturalPinchZoom(t){const i=this.inputs.attached.pointers;i&&(i.useNaturalPinchZoom=t)}get panningSensibility(){const t=this.inputs.attached.pointers;return t?t.panningSensibility:0}set panningSensibility(t){const i=this.inputs.attached.pointers;i&&(i.panningSensibility=t)}get keysUp(){const t=this.inputs.attached.keyboard;return t?t.keysUp:[]}set keysUp(t){const i=this.inputs.attached.keyboard;i&&(i.keysUp=t)}get keysDown(){const t=this.inputs.attached.keyboard;return t?t.keysDown:[]}set keysDown(t){const i=this.inputs.attached.keyboard;i&&(i.keysDown=t)}get keysLeft(){const t=this.inputs.attached.keyboard;return t?t.keysLeft:[]}set keysLeft(t){const i=this.inputs.attached.keyboard;i&&(i.keysLeft=t)}get keysRight(){const t=this.inputs.attached.keyboard;return t?t.keysRight:[]}set keysRight(t){const i=this.inputs.attached.keyboard;i&&(i.keysRight=t)}get wheelPrecision(){const t=this.inputs.attached.mousewheel;return t?t.wheelPrecision:0}set wheelPrecision(t){const i=this.inputs.attached.mousewheel;i&&(i.wheelPrecision=t)}get zoomToMouseLocation(){const t=this.inputs.attached.mousewheel;return!!t&&t.zoomToMouseLocation}set zoomToMouseLocation(t){const i=this.inputs.attached.mousewheel;i&&(i.zoomToMouseLocation=t)}get wheelDeltaPercentage(){const t=this.inputs.attached.mousewheel;return t?t.wheelDeltaPercentage:0}set wheelDeltaPercentage(t){const i=this.inputs.attached.mousewheel;i&&(i.wheelDeltaPercentage=t)}get bouncingBehavior(){return this._bouncingBehavior}get useBouncingBehavior(){return null!=this._bouncingBehavior}set useBouncingBehavior(t){t!==this.useBouncingBehavior&&(t?(this._bouncingBehavior=new c.r,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))}get framingBehavior(){return this._framingBehavior}get useFramingBehavior(){return null!=this._framingBehavior}set useFramingBehavior(t){t!==this.useFramingBehavior&&(t?(this._framingBehavior=new u.d,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))}get autoRotationBehavior(){return this._autoRotationBehavior}get useAutoRotationBehavior(){return null!=this._autoRotationBehavior}set useAutoRotationBehavior(t){t!==this.useAutoRotationBehavior&&(t?(this._autoRotationBehavior=new l.o,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))}constructor(t,i,e,s,a,r,h=!0){super(t,o.P.Zero(),r,h),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.lowerAlphaLimit=null,this.upperAlphaLimit=null,this.lowerBetaLimit=.01,this.upperBetaLimit=Math.PI-.01,this.lowerRadiusLimit=null,this.upperRadiusLimit=null,this.inertialPanningX=0,this.inertialPanningY=0,this.pinchToPanMaxDistance=20,this.panningDistanceLimit=null,this.panningOriginTarget=o.P.Zero(),this.panningInertia=.9,this.zoomOnFactor=1,this.targetScreenOffset=o.FM.Zero(),this.allowUpsideDown=!0,this.useInputToRestoreState=!0,this._viewMatrix=new o.y3,this.panningAxis=new o.P(1,1,0),this._transformedDirection=new o.P,this.mapPanning=!1,this.onMeshTargetChangedObservable=new n.y$,this.checkCollisions=!1,this.collisionRadius=new o.P(.5,.5,.5),this._previousPosition=o.P.Zero(),this._collisionVelocity=o.P.Zero(),this._newPosition=o.P.Zero(),this._computationVector=o.P.Zero(),this._onCollisionPositionChange=(t,i,e=null)=>{e?(this.setPosition(i),this.onCollide&&this.onCollide(e)):this._previousPosition.copyFrom(this._position);const s=Math.cos(this.alpha),a=Math.sin(this.alpha),n=Math.cos(this.beta);let o=Math.sin(this.beta);0===o&&(o=1e-4);const r=this._getTargetPosition();this._computationVector.copyFromFloats(this.radius*s*o,this.radius*n,this.radius*a*o),r.addToRef(this._computationVector,this._newPosition),this._position.copyFrom(this._newPosition);let h=this.upVector;this.allowUpsideDown&&this.beta<0&&(h=h.clone(),h=h.negate()),this._computeViewMatrix(this._position,r,h),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y),this._collisionTriggered=!1},this._target=o.P.Zero(),a&&this.setTarget(a),this.alpha=i,this.beta=e,this.radius=s,this.getViewMatrix(),this.inputs=new _.$(this),this.inputs.addKeyboard().addMouseWheel().addPointers()}_initCache(){super._initCache(),this._cache._target=new o.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=o.FM.Zero()}_updateCache(t){t||super._updateCache(),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)}_getTargetPosition(){if(this._targetHost&&this._targetHost.getAbsolutePosition){const t=this._targetHost.getAbsolutePosition();this._targetBoundingCenter?t.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(t)}return this._getLockedTargetPosition()||this._target}storeState(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),this._storedTargetScreenOffset=this.targetScreenOffset.clone(),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.setTarget(this._storedTarget.clone()),this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.targetScreenOffset=this._storedTargetScreenOffset.clone(),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0)}_isSynchronizedViewMatrix(){return!!super._isSynchronizedViewMatrix()&&this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset)}attachControl(t,i,e=!0,s=2){const a=arguments;i=g.w1.BackCompatCameraNoPreventDefault(a),this._useCtrlForPanning=e,this._panningMouseButton=s,"boolean"==typeof a[0]&&(a.length>1&&(this._useCtrlForPanning=a[1]),a.length>2&&(this._panningMouseButton=a[2])),this.inputs.attachElement(i),this._reset=()=>{this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0}}detachControl(){this.inputs.detachElement(),this._reset&&this._reset()}_checkInputs(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){const t=this.invertRotation?-1:1;let i=this.inertialAlphaOffset;this.beta<=0&&(i*=-1),this.getScene().useRightHandedSystem&&(i*=-1),this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(i*=-1),this.alpha+=i*t,this.beta+=this.inertialBetaOffset*t,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<m.kn&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<m.kn&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*m.kn&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY){const t=new o.P(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY);this._viewMatrix.invertToRef(this._cameraTransformMatrix),t.multiplyInPlace(this.panningAxis),o.P.TransformNormalToRef(t,this._cameraTransformMatrix,this._transformedDirection),!this.mapPanning&&this.panningAxis.y||(this._transformedDirection.y=0),this._targetHost||(this.panningDistanceLimit?(this._transformedDirection.addInPlace(this._target),o.P.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection)):this._target.addInPlace(this._transformedDirection)),this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*m.kn&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*m.kn&&(this.inertialPanningY=0)}this._checkLimits(),super._checkInputs()}}_checkLimits(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)}rebuildAnglesAndRadius(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||o.P.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector),this.radius=this._computationVector.length(),0===this.radius&&(this.radius=1e-4);const t=this.alpha;0===this._computationVector.x&&0===this._computationVector.z?this.alpha=Math.PI/2:this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha);const i=Math.round((t-this.alpha)/(2*Math.PI));this.alpha+=2*i*Math.PI,this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()}setPosition(t){this._position.equals(t)||(this._position.copyFrom(t),this.rebuildAnglesAndRadius())}setTarget(t,i=!1,e=!1,s=!1){var a;if(s=null!==(a=this.overrideCloneAlphaBetaRadius)&&void 0!==a?a:s,t.getBoundingInfo)this._targetBoundingCenter=i?t.getBoundingInfo().boundingBox.centerWorld.clone():null,t.computeWorldMatrix(),this._targetHost=t,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{const i=t,s=this._getTargetPosition();if(s&&!e&&s.equals(i))return;this._targetHost=null,this._target=i,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}s||this.rebuildAnglesAndRadius()}_getViewMatrix(){const t=Math.cos(this.alpha),i=Math.sin(this.alpha),e=Math.cos(this.beta);let s=Math.sin(this.beta);0===s&&(s=1e-4),0===this.radius&&(this.radius=1e-4);const a=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*t*s,this.radius*e,this.radius*i*s),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||o.P.TransformCoordinatesToRef(this._computationVector,this._yToUpMatrix,this._computationVector),a.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions){const t=this.getScene().collisionCoordinator;this._collider||(this._collider=t.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,t.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}else{this._position.copyFrom(this._newPosition);let t=this.upVector;this.allowUpsideDown&&s<0&&(t=t.negate()),this._computeViewMatrix(this._position,a,t),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=a,this._viewMatrix}zoomOn(t,i=!1){t=t||this.getScene().meshes;const e=h.Kj.MinMax(t),s=o.P.Distance(e.min,e.max);this.radius=s*this.zoomOnFactor,this.focusOn({min:e.min,max:e.max,distance:s},i)}focusOn(t,i=!1){let e,s;if(void 0===t.min){const i=t||this.getScene().meshes;e=h.Kj.MinMax(i),s=o.P.Distance(e.min,e.max)}else e=t,s=t.distance;this._target=h.Kj.Center(e),i||(this.maxZ=2*s)}createRigCamera(t,i){let e=0;switch(this.cameraRigMode){case d.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case d.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case d.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case d.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case d.V.RIG_MODE_VR:e=this._cameraRigParams.stereoHalfAngle*(0===i?1:-1);break;case d.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:e=this._cameraRigParams.stereoHalfAngle*(0===i?-1:1)}const s=new f(t,this.alpha+e,this.beta,this.radius,this._target,this.getScene());return s._cameraRigParams={},s.isRigCamera=!0,s.rigParent=this,s.upVector=this.upVector,s.mode=this.mode,s.orthoLeft=this.orthoLeft,s.orthoRight=this.orthoRight,s.orthoBottom=this.orthoBottom,s.orthoTop=this.orthoTop,s}_updateRigCameras(){const t=this._rigCameras[0],i=this._rigCameras[1];switch(t.beta=i.beta=this.beta,this.cameraRigMode){case d.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case d.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case d.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case d.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case d.V.RIG_MODE_VR:t.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,i.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case d.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:t.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,i.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}super._updateRigCameras()}dispose(){this.inputs.clear(),super.dispose()}getClassName(){return"ArcRotateCamera"}}(0,s.gn)([(0,a.qC)()],f.prototype,"alpha",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"beta",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"radius",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"overrideCloneAlphaBetaRadius",void 0),(0,s.gn)([(0,a.hd)("target")],f.prototype,"_target",void 0),(0,s.gn)([(0,a.RR)("targetHost")],f.prototype,"_targetHost",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"inertialAlphaOffset",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"inertialBetaOffset",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"inertialRadiusOffset",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"lowerAlphaLimit",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"upperAlphaLimit",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"lowerBetaLimit",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"upperBetaLimit",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"lowerRadiusLimit",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"upperRadiusLimit",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"inertialPanningX",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"inertialPanningY",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"pinchToPanMaxDistance",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"panningDistanceLimit",void 0),(0,s.gn)([(0,a.hd)()],f.prototype,"panningOriginTarget",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"panningInertia",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"zoomToMouseLocation",null),(0,s.gn)([(0,a.qC)()],f.prototype,"zoomOnFactor",void 0),(0,s.gn)([(0,a.QC)()],f.prototype,"targetScreenOffset",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"allowUpsideDown",void 0),(0,s.gn)([(0,a.qC)()],f.prototype,"useInputToRestoreState",void 0)},54946:(t,i,e)=>{e.d(i,{$:()=>r});var s=e(55630),a=e(34452),n=e(17366),o=e(4442);class r extends o.p{constructor(t){super(t)}addMouseWheel(){return this.add(new n.F),this}addPointers(){return this.add(new s.H),this}addKeyboard(){return this.add(new a.v),this}}}}]);
//# sourceMappingURL=559.babylonBundle.js.map