"use strict";(self.webpackChunkbabylonjs_typescript_webpack_template=self.webpackChunkbabylonjs_typescript_webpack_template||[]).push([[579],{3427:(t,e,i)=>{i.d(e,{f:()=>_,u:()=>d});var n=i(972),s=i(9859),a=i(1865),o=i(6786),r=i(9827),h=i(4629),l=i(9556),c=i(2528),u=i(7743),p=i(2059);class d{}class _{static _PrepareAnimation(t,e,i,a,o,r,h,l){let c;if(!isNaN(parseFloat(o))&&isFinite(o)?c=_.ANIMATIONTYPE_FLOAT:o instanceof n._f?c=_.ANIMATIONTYPE_QUATERNION:o instanceof n.P?c=_.ANIMATIONTYPE_VECTOR3:o instanceof n.FM?c=_.ANIMATIONTYPE_VECTOR2:o instanceof s.Wo?c=_.ANIMATIONTYPE_COLOR3:o instanceof s.HE?c=_.ANIMATIONTYPE_COLOR4:o instanceof u.$&&(c=_.ANIMATIONTYPE_SIZE),null==c)return null;const p=new _(t,e,i,c,h),d=[{frame:0,value:o},{frame:a,value:r}];return p.setKeys(d),void 0!==l&&p.setEasingFunction(l),p}static CreateAnimation(t,e,i,n){const s=new _(t+"Animation",t,i,e,_.ANIMATIONLOOPMODE_CONSTANT);return s.setEasingFunction(n),s}static CreateAndStartAnimation(t,e,i,n,s,a,o,r,h,l,c){const u=_._PrepareAnimation(t,i,n,s,a,o,r,h);return u?(e.getScene&&(c=e.getScene()),c?c.beginDirectAnimation(e,[u],0,s,1===u.loopMode,1,l):null):null}static CreateAndStartHierarchyAnimation(t,e,i,n,s,a,o,r,h,l,c){const u=_._PrepareAnimation(t,n,s,a,o,r,h,l);return u?e.getScene().beginDirectHierarchyAnimation(e,i,[u],0,a,1===u.loopMode,1,c):null}static CreateMergeAndStartAnimation(t,e,i,n,s,a,o,r,h,l){const c=_._PrepareAnimation(t,i,n,s,a,o,r,h);return c?(e.animations.push(c),e.getScene().beginAnimation(e,0,s,1===c.loopMode,1,l)):null}static MakeAnimationAdditive(t,e=0,i,s=!1,a){let o=t;if(s&&(o=t.clone(),o.name=a||o.name),!o._keys.length)return o;e=e>=0?e:0;let r=0;const h=o._keys[0];let l=o._keys.length-1;const c=o._keys[l],u={referenceValue:h.value,referencePosition:n.jp.Vector3[0],referenceQuaternion:n.jp.Quaternion[0],referenceScaling:n.jp.Vector3[1],keyPosition:n.jp.Vector3[2],keyQuaternion:n.jp.Quaternion[1],keyScaling:n.jp.Vector3[3]};let p=!1,d=h.frame,m=c.frame;if(i){const t=o.getRange(i);t&&(d=t.from,m=t.to)}let g=h.frame===d,f=c.frame===m;if(1===o._keys.length){const t=o._getKeyValue(o._keys[0]);u.referenceValue=t.clone?t.clone():t,p=!0}else if(e<=h.frame){const t=o._getKeyValue(h.value);u.referenceValue=t.clone?t.clone():t,p=!0}else if(e>=c.frame){const t=o._getKeyValue(c.value);u.referenceValue=t.clone?t.clone():t,p=!0}let O=0;for(;!p||!g||!f&&O<o._keys.length-1;){const t=o._keys[O],i=o._keys[O+1];if(!p&&e>=t.frame&&e<=i.frame){let n;if(e===t.frame)n=o._getKeyValue(t.value);else if(e===i.frame)n=o._getKeyValue(i.value);else{const t={key:O,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT};n=o._interpolate(e,t)}u.referenceValue=n.clone?n.clone():n,p=!0}if(!g&&d>=t.frame&&d<=i.frame){if(d===t.frame)r=O;else if(d===i.frame)r=O+1;else{const t={key:O,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},e=o._interpolate(d,t),i={frame:d,value:e.clone?e.clone():e};o._keys.splice(O+1,0,i),r=O+1}g=!0}if(!f&&m>=t.frame&&m<=i.frame){if(m===t.frame)l=O;else if(m===i.frame)l=O+1;else{const t={key:O,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},e=o._interpolate(m,t),i={frame:m,value:e.clone?e.clone():e};o._keys.splice(O+1,0,i),l=O+1}f=!0}O++}for(o.dataType===_.ANIMATIONTYPE_QUATERNION?u.referenceValue.normalize().conjugateInPlace():o.dataType===_.ANIMATIONTYPE_MATRIX&&(u.referenceValue.decompose(u.referenceScaling,u.referenceQuaternion,u.referencePosition),u.referenceQuaternion.normalize().conjugateInPlace()),O=r;O<=l;O++){const t=o._keys[O];if(!O||o.dataType===_.ANIMATIONTYPE_FLOAT||t.value!==h.value)switch(o.dataType){case _.ANIMATIONTYPE_MATRIX:t.value.decompose(u.keyScaling,u.keyQuaternion,u.keyPosition),u.keyPosition.subtractInPlace(u.referencePosition),u.keyScaling.divideInPlace(u.referenceScaling),u.referenceQuaternion.multiplyToRef(u.keyQuaternion,u.keyQuaternion),n.y3.ComposeToRef(u.keyScaling,u.keyQuaternion,u.keyPosition,t.value);break;case _.ANIMATIONTYPE_QUATERNION:u.referenceValue.multiplyToRef(t.value,t.value);break;case _.ANIMATIONTYPE_VECTOR2:case _.ANIMATIONTYPE_VECTOR3:case _.ANIMATIONTYPE_COLOR3:case _.ANIMATIONTYPE_COLOR4:t.value.subtractToRef(u.referenceValue,t.value);break;case _.ANIMATIONTYPE_SIZE:t.value.width-=u.referenceValue.width,t.value.height-=u.referenceValue.height;break;default:t.value-=u.referenceValue}}return o}static TransitionTo(t,e,i,n,s,a,o,r=null){if(o<=0)return i[t]=e,r&&r(),null;const h=s*(o/1e3);a.setKeys([{frame:0,value:i[t].clone?i[t].clone():i[t]},{frame:h,value:e}]),i.animations||(i.animations=[]),i.animations.push(a);const l=n.beginAnimation(i,0,h,!1);return l.onAnimationEnd=r,l}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const t of this._runtimeAnimations)if(!t.isStopped())return!0;return!1}constructor(t,e,i,n,s,a){this.name=t,this.targetProperty=e,this.framePerSecond=i,this.dataType=n,this.loopMode=s,this.enableBlending=a,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=e.split("."),this.dataType=n,this.loopMode=void 0===s?_.ANIMATIONLOOPMODE_CYCLE:s,this.uniqueId=_._UniqueIdGenerator++}toString(t){let e="Name: "+this.name+", property: "+this.targetProperty;if(e+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],e+=", nKeys: "+(this._keys?this._keys.length:"none"),e+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),t){e+=", Ranges: {";let t=!0;for(const i in this._ranges)t&&(e+=", ",t=!1),e+=i;e+="}"}return e}addEvent(t){this._events.push(t),this._events.sort(((t,e)=>t.frame-e.frame))}removeEvents(t){for(let e=0;e<this._events.length;e++)this._events[e].frame===t&&(this._events.splice(e,1),e--)}getEvents(){return this._events}createRange(t,e,i){this._ranges[t]||(this._ranges[t]=new l.X(t,e,i))}deleteRange(t,e=!0){const i=this._ranges[t];if(i){if(e){const t=i.from,e=i.to;for(let i=this._keys.length-1;i>=0;i--)this._keys[i].frame>=t&&this._keys[i].frame<=e&&this._keys.splice(i,1)}this._ranges[t]=null}}getRange(t){return this._ranges[t]}getKeys(){return this._keys}getHighestFrame(){let t=0;for(let e=0,i=this._keys.length;e<i;e++)t<this._keys[e].frame&&(t=this._keys[e].frame);return t}getEasingFunction(){return this._easingFunction}setEasingFunction(t){this._easingFunction=t}floatInterpolateFunction(t,e,i){return a.R.Lerp(t,e,i)}floatInterpolateFunctionWithTangents(t,e,i,n,s){return a.R.Hermite(t,e,i,n,s)}quaternionInterpolateFunction(t,e,i){return n._f.Slerp(t,e,i)}quaternionInterpolateFunctionWithTangents(t,e,i,s,a){return n._f.Hermite(t,e,i,s,a).normalize()}vector3InterpolateFunction(t,e,i){return n.P.Lerp(t,e,i)}vector3InterpolateFunctionWithTangents(t,e,i,s,a){return n.P.Hermite(t,e,i,s,a)}vector2InterpolateFunction(t,e,i){return n.FM.Lerp(t,e,i)}vector2InterpolateFunctionWithTangents(t,e,i,s,a){return n.FM.Hermite(t,e,i,s,a)}sizeInterpolateFunction(t,e,i){return u.$.Lerp(t,e,i)}color3InterpolateFunction(t,e,i){return s.Wo.Lerp(t,e,i)}color3InterpolateFunctionWithTangents(t,e,i,n,a){return s.Wo.Hermite(t,e,i,n,a)}color4InterpolateFunction(t,e,i){return s.HE.Lerp(t,e,i)}color4InterpolateFunctionWithTangents(t,e,i,n,a){return s.HE.Hermite(t,e,i,n,a)}_getKeyValue(t){return"function"==typeof t?t():t}evaluate(t){return this._interpolate(t,{key:0,repeatCount:0,loopMode:_.ANIMATIONLOOPMODE_CONSTANT})}_interpolate(t,e){if(e.loopMode===_.ANIMATIONLOOPMODE_CONSTANT&&e.repeatCount>0)return e.highLimitValue.clone?e.highLimitValue.clone():e.highLimitValue;const i=this._keys,n=i.length;let s=e.key;for(;s>=0&&t<i[s].frame;)--s;for(;s+1<=n-1&&t>=i[s+1].frame;)++s;if(e.key=s,s<0)return this._getKeyValue(i[0].value);if(s+1>n-1)return this._getKeyValue(i[n-1].value);const a=i[s],o=i[s+1],r=this._getKeyValue(a.value),l=this._getKeyValue(o.value);if(a.interpolation===h.N.STEP)return o.frame>t?r:l;const c=void 0!==a.outTangent&&void 0!==o.inTangent,u=o.frame-a.frame;let p=(t-a.frame)/u;const d=this.getEasingFunction();switch(null!==d&&(p=d.ease(p)),this.dataType){case _.ANIMATIONTYPE_FLOAT:{const t=c?this.floatInterpolateFunctionWithTangents(r,a.outTangent*u,l,o.inTangent*u,p):this.floatInterpolateFunction(r,l,p);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return e.offsetValue*e.repeatCount+t}break}case _.ANIMATIONTYPE_QUATERNION:{const t=c?this.quaternionInterpolateFunctionWithTangents(r,a.outTangent.scale(u),l,o.inTangent.scale(u),p):this.quaternionInterpolateFunction(r,l,p);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.addInPlace(e.offsetValue.scale(e.repeatCount))}return t}case _.ANIMATIONTYPE_VECTOR3:{const t=c?this.vector3InterpolateFunctionWithTangents(r,a.outTangent.scale(u),l,o.inTangent.scale(u),p):this.vector3InterpolateFunction(r,l,p);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_VECTOR2:{const t=c?this.vector2InterpolateFunctionWithTangents(r,a.outTangent.scale(u),l,o.inTangent.scale(u),p):this.vector2InterpolateFunction(r,l,p);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_SIZE:switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(r,l,p);case _.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(r,l,p).add(e.offsetValue.scale(e.repeatCount))}break;case _.ANIMATIONTYPE_COLOR3:{const t=c?this.color3InterpolateFunctionWithTangents(r,a.outTangent.scale(u),l,o.inTangent.scale(u),p):this.color3InterpolateFunction(r,l,p);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_COLOR4:{const t=c?this.color4InterpolateFunctionWithTangents(r,a.outTangent.scale(u),l,o.inTangent.scale(u),p):this.color4InterpolateFunction(r,l,p);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_MATRIX:switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return _.AllowMatricesInterpolation?this.matrixInterpolateFunction(r,l,p,e.workValue):r;case _.ANIMATIONLOOPMODE_RELATIVE:return r}}return 0}matrixInterpolateFunction(t,e,i,s){return _.AllowMatrixDecomposeForInterpolation?s?(n.y3.DecomposeLerpToRef(t,e,i,s),s):n.y3.DecomposeLerp(t,e,i):s?(n.y3.LerpToRef(t,e,i,s),s):n.y3.Lerp(t,e,i)}clone(){const t=new _(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed,this._keys&&t.setKeys(this._keys),this._ranges){t._ranges={};for(const e in this._ranges){const i=this._ranges[e];i&&(t._ranges[e]=i.clone())}}return t}setKeys(t){this._keys=t.slice(0)}serialize(){const t={};t.name=this.name,t.property=this.targetProperty,t.framePerSecond=this.framePerSecond,t.dataType=this.dataType,t.loopBehavior=this.loopMode,t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed;const e=this.dataType;t.keys=[];const i=this.getKeys();for(let n=0;n<i.length;n++){const s=i[n],a={};switch(a.frame=s.frame,e){case _.ANIMATIONTYPE_FLOAT:a.values=[s.value],void 0!==s.inTangent&&a.values.push(s.inTangent),void 0!==s.outTangent&&(void 0===s.inTangent&&a.values.push(void 0),a.values.push(s.outTangent)),void 0!==s.interpolation&&(void 0===s.inTangent&&a.values.push(void 0),void 0===s.outTangent&&a.values.push(void 0),a.values.push(s.interpolation));break;case _.ANIMATIONTYPE_QUATERNION:case _.ANIMATIONTYPE_MATRIX:case _.ANIMATIONTYPE_VECTOR3:case _.ANIMATIONTYPE_COLOR3:case _.ANIMATIONTYPE_COLOR4:a.values=s.value.asArray(),null!=s.inTangent&&a.values.push(s.inTangent.asArray()),null!=s.outTangent&&(void 0===s.inTangent&&a.values.push(void 0),a.values.push(s.outTangent.asArray())),void 0!==s.interpolation&&(void 0===s.inTangent&&a.values.push(void 0),void 0===s.outTangent&&a.values.push(void 0),a.values.push(s.interpolation))}t.keys.push(a)}t.ranges=[];for(const e in this._ranges){const i=this._ranges[e];if(!i)continue;const n={};n.name=e,n.from=i.from,n.to=i.to,t.ranges.push(n)}return t}static _UniversalLerp(t,e,i){const n=t.constructor;return n.Lerp?n.Lerp(t,e,i):n.Slerp?n.Slerp(t,e,i):t.toFixed?t*(1-i)+i*e:e}static Parse(t){const e=new _(t.name,t.property,t.framePerSecond,t.dataType,t.loopBehavior),i=t.dataType,a=[];let o,r;for(t.enableBlending&&(e.enableBlending=t.enableBlending),t.blendingSpeed&&(e.blendingSpeed=t.blendingSpeed),r=0;r<t.keys.length;r++){const e=t.keys[r];let h,l,c;switch(i){case _.ANIMATIONTYPE_FLOAT:o=e.values[0],e.values.length>=2&&(h=e.values[1]),e.values.length>=3&&(l=e.values[2]),e.values.length>=4&&(c=e.values[3]);break;case _.ANIMATIONTYPE_QUATERNION:if(o=n._f.FromArray(e.values),e.values.length>=8){const t=n._f.FromArray(e.values.slice(4,8));t.equals(n._f.Zero())||(h=t)}if(e.values.length>=12){const t=n._f.FromArray(e.values.slice(8,12));t.equals(n._f.Zero())||(l=t)}e.values.length>=13&&(c=e.values[12]);break;case _.ANIMATIONTYPE_MATRIX:o=n.y3.FromArray(e.values),e.values.length>=17&&(c=e.values[16]);break;case _.ANIMATIONTYPE_COLOR3:o=s.Wo.FromArray(e.values),e.values[3]&&(h=s.Wo.FromArray(e.values[3])),e.values[4]&&(l=s.Wo.FromArray(e.values[4])),e.values[5]&&(c=e.values[5]);break;case _.ANIMATIONTYPE_COLOR4:o=s.HE.FromArray(e.values),e.values[4]&&(h=s.HE.FromArray(e.values[4])),e.values[5]&&(l=s.HE.FromArray(e.values[5])),e.values[6]&&(c=s.HE.FromArray(e.values[6]));break;case _.ANIMATIONTYPE_VECTOR3:default:o=n.P.FromArray(e.values),e.values[3]&&(h=n.P.FromArray(e.values[3])),e.values[4]&&(l=n.P.FromArray(e.values[4])),e.values[5]&&(c=e.values[5])}const u={};u.frame=e.frame,u.value=o,null!=h&&(u.inTangent=h),null!=l&&(u.outTangent=l),null!=c&&(u.interpolation=c),a.push(u)}if(e.setKeys(a),t.ranges)for(r=0;r<t.ranges.length;r++)o=t.ranges[r],e.createRange(o.name,o.from,o.to);return e}static AppendSerializedAnimations(t,e){o.p4.AppendSerializedAnimations(t,e)}static ParseFromFileAsync(t,e){return new Promise(((i,n)=>{const s=new p.g;s.addEventListener("readystatechange",(()=>{if(4==s.readyState)if(200==s.status){let e=JSON.parse(s.responseText);if(e.animations&&(e=e.animations),e.length){const t=new Array;for(const i of e)t.push(this.Parse(i));i(t)}else{const n=this.Parse(e);t&&(n.name=t),i(n)}}else n("Unable to load the animation")})),s.open("GET",e),s.send()}))}static ParseFromSnippetAsync(t){return new Promise(((e,i)=>{const n=new p.g;n.addEventListener("readystatechange",(()=>{if(4==n.readyState)if(200==n.status){const i=JSON.parse(JSON.parse(n.responseText).jsonPayload);if(i.animations){const n=JSON.parse(i.animations),s=new Array;for(const e of n.animations){const i=this.Parse(e);i.snippetId=t,s.push(i)}e(s)}else{const n=JSON.parse(i.animation),s=this.Parse(n);s.snippetId=t,e(s)}}else i("Unable to load the snippet "+t)})),n.open("GET",this.SnippetUrl+"/"+t.replace(/#/g,"/")),n.send()}))}}_._UniqueIdGenerator=0,_.AllowMatricesInterpolation=!1,_.AllowMatrixDecomposeForInterpolation=!0,_.SnippetUrl="https://snippet.babylonjs.com",_.ANIMATIONTYPE_FLOAT=0,_.ANIMATIONTYPE_VECTOR3=1,_.ANIMATIONTYPE_QUATERNION=2,_.ANIMATIONTYPE_MATRIX=3,_.ANIMATIONTYPE_COLOR3=4,_.ANIMATIONTYPE_COLOR4=7,_.ANIMATIONTYPE_VECTOR2=5,_.ANIMATIONTYPE_SIZE=6,_.ANIMATIONLOOPMODE_RELATIVE=0,_.ANIMATIONLOOPMODE_CYCLE=1,_.ANIMATIONLOOPMODE_CONSTANT=2,_.CreateFromSnippetAsync=_.ParseFromSnippetAsync,(0,r.H)("BABYLON.Animation",_),c.N._AnimationRangeFactory=(t,e,i)=>new l.X(t,e,i)},4629:(t,e,i)=>{var n;i.d(e,{N:()=>n}),function(t){t[t.NONE=0]="NONE",t[t.STEP=1]="STEP"}(n||(n={}))},9556:(t,e,i)=>{i.d(e,{X:()=>n});class n{constructor(t,e,i){this.name=t,this.from=e,this.to=i}clone(){return new n(this.name,this.from,this.to)}}},9011:(t,e,i)=>{i.d(e,{$A:()=>l,EI:()=>c,Kp:()=>s,Pu:()=>u,R$:()=>r,TO:()=>d,bi:()=>m,m2:()=>_,o0:()=>h,qP:()=>a,sj:()=>g,ud:()=>o,v:()=>p});var n=i(1021);class s{constructor(){this._easingMode=s.EASINGMODE_EASEIN}setEasingMode(t){const e=Math.min(Math.max(t,0),2);this._easingMode=e}getEasingMode(){return this._easingMode}easeInCore(t){throw new Error("You must implement this method")}ease(t){switch(this._easingMode){case s.EASINGMODE_EASEIN:return this.easeInCore(t);case s.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-t)}return t>=.5?.5*(1-this.easeInCore(2*(1-t)))+.5:.5*this.easeInCore(2*t)}}s.EASINGMODE_EASEIN=0,s.EASINGMODE_EASEOUT=1,s.EASINGMODE_EASEINOUT=2;class a extends s{easeInCore(t){return t=Math.max(0,Math.min(1,t)),1-Math.sqrt(1-t*t)}}class o extends s{constructor(t=1){super(),this.amplitude=t}easeInCore(t){const e=Math.max(0,this.amplitude);return Math.pow(t,3)-t*e*Math.sin(3.141592653589793*t)}}class r extends s{constructor(t=3,e=2){super(),this.bounces=t,this.bounciness=e}easeInCore(t){const e=Math.max(0,this.bounces);let i=this.bounciness;i<=1&&(i=1.001);const n=Math.pow(i,e),s=1-i,a=(1-n)/s+.5*n,o=t*a,r=Math.log(-o*(1-i)+1)/Math.log(i),h=Math.floor(r),l=h+1,c=(1-Math.pow(i,h))/(s*a),u=.5*(c+(1-Math.pow(i,l))/(s*a)),p=t-u,d=u-c;return-Math.pow(1/i,e-h)/(d*d)*(p-d)*(p+d)}}class h extends s{easeInCore(t){return t*t*t}}class l extends s{constructor(t=3,e=3){super(),this.oscillations=t,this.springiness=e}easeInCore(t){let e;const i=Math.max(0,this.oscillations),n=Math.max(0,this.springiness);return e=0==n?t:(Math.exp(n*t)-1)/(Math.exp(n)-1),e*Math.sin((6.283185307179586*i+1.5707963267948966)*t)}}class c extends s{constructor(t=2){super(),this.exponent=t}easeInCore(t){return this.exponent<=0?t:(Math.exp(this.exponent*t)-1)/(Math.exp(this.exponent)-1)}}class u extends s{constructor(t=2){super(),this.power=t}easeInCore(t){const e=Math.max(0,this.power);return Math.pow(t,e)}}class p extends s{easeInCore(t){return t*t}}class d extends s{easeInCore(t){return t*t*t*t}}class _ extends s{easeInCore(t){return t*t*t*t*t}}class m extends s{easeInCore(t){return 1-Math.sin(1.5707963267948966*(1-t))}}class g extends s{constructor(t=0,e=0,i=1,n=1){super(),this.x1=t,this.y1=e,this.x2=i,this.y2=n}easeInCore(t){return n.hr.Interpolate(t,this.x1,this.y1,this.x2,this.y2)}}},1480:(t,e,i)=>{i.d(e,{o:()=>o});var n=i(147),s=i(6461),a=i(7786);class o{constructor(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this.targetAlpha=null,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}get name(){return"AutoRotation"}set zoomStopsAnimation(t){this._zoomStopsAnimation=t}get zoomStopsAnimation(){return this._zoomStopsAnimation}set idleRotationSpeed(t){this._idleRotationSpeed=t}get idleRotationSpeed(){return this._idleRotationSpeed}set idleRotationWaitTime(t){this._idleRotationWaitTime=t}get idleRotationWaitTime(){return this._idleRotationWaitTime}set idleRotationSpinupTime(t){this._idleRotationSpinupTime=t}get idleRotationSpinupTime(){return this._idleRotationSpinupTime}get rotationInProgress(){return Math.abs(this._cameraRotationSpeed)>0}init(){}attach(t){this._attachedCamera=t;const e=this._attachedCamera.getScene();this._onPrePointerObservableObserver=e.onPrePointerObservable.add((t=>{t.type!==n.kD.POINTERDOWN?t.type===n.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{if(this._reachTargetAlpha())return;const t=s.F.Now;let e=0;null!=this._lastFrameTime&&(e=t-this._lastFrameTime),this._lastFrameTime=t,this._applyUserInteraction();const i=t-this._lastInteractionTime-this._idleRotationWaitTime,n=Math.max(Math.min(i/this._idleRotationSpinupTime,1),0);this._cameraRotationSpeed=this._idleRotationSpeed*n,this._attachedCamera&&(this._attachedCamera.alpha-=this._cameraRotationSpeed*(e/1e3))}))}detach(){if(!this._attachedCamera)return;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}resetLastInteractionTime(t){this._lastInteractionTime=null!=t?t:s.F.Now}_reachTargetAlpha(){return!(!this._attachedCamera||!this.targetAlpha)&&Math.abs(this._attachedCamera.alpha-this.targetAlpha)<a.kn}_userIsZooming(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset}_shouldAnimationStopForInteraction(){if(!this._attachedCamera)return!1;let t=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(t=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?t:this._userIsZooming()}_applyUserInteraction(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=s.F.Now)}_userIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}},3425:(t,e,i)=>{i.d(e,{r:()=>a});var n=i(9011),s=i(3427);class a{constructor(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}get name(){return"Bouncing"}get autoTransitionRange(){return this._autoTransitionRange}set autoTransitionRange(t){if(this._autoTransitionRange===t)return;this._autoTransitionRange=t;const e=this._attachedCamera;e&&(t?this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add((t=>{if(!t)return;t.computeWorldMatrix(!0);const e=t.getBoundingInfo().diagonalLength;this.lowerRadiusTransitionRange=.05*e,this.upperRadiusTransitionRange=.05*e})):this._onMeshTargetChangedObserver&&e.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}init(){}attach(t){this._attachedCamera=t,this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{this._attachedCamera&&(this._isRadiusAtLimit(this._attachedCamera.lowerRadiusLimit)&&this._applyBoundRadiusAnimation(this.lowerRadiusTransitionRange),this._isRadiusAtLimit(this._attachedCamera.upperRadiusLimit)&&this._applyBoundRadiusAnimation(this.upperRadiusTransitionRange))}))}detach(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)}_isRadiusAtLimit(t){return!!this._attachedCamera&&this._attachedCamera.radius===t&&!this._radiusIsAnimating}_applyBoundRadiusAnimation(t){if(!this._attachedCamera)return;this._radiusBounceTransition||(a.EasingFunction.setEasingMode(a.EasingMode),this._radiusBounceTransition=s.f.CreateAnimation("radius",s.f.ANIMATIONTYPE_FLOAT,60,a.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;const e=s.f.TransitionTo("radius",this._attachedCamera.radius+t,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,(()=>this._clearAnimationLocks()));e&&this._animatables.push(e)}_clearAnimationLocks(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()}}a.EasingFunction=new n.ud(.3),a.EasingMode=n.Kp.EASINGMODE_EASEOUT},1193:(t,e,i)=>{i.d(e,{d:()=>l});var n=i(9011),s=i(4673),a=i(147),o=i(6461),r=i(972),h=i(3427);class l{constructor(){this.onTargetFramingAnimationEndObservable=new s.y$,this._mode=l.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}get name(){return"Framing"}set mode(t){this._mode=t}get mode(){return this._mode}set radiusScale(t){this._radiusScale=t}get radiusScale(){return this._radiusScale}set positionScale(t){this._positionScale=t}get positionScale(){return this._positionScale}set defaultElevation(t){this._defaultElevation=t}get defaultElevation(){return this._defaultElevation}set elevationReturnTime(t){this._elevationReturnTime=t}get elevationReturnTime(){return this._elevationReturnTime}set elevationReturnWaitTime(t){this._elevationReturnWaitTime=t}get elevationReturnWaitTime(){return this._elevationReturnWaitTime}set zoomStopsAnimation(t){this._zoomStopsAnimation=t}get zoomStopsAnimation(){return this._zoomStopsAnimation}set framingTime(t){this._framingTime=t}get framingTime(){return this._framingTime}init(){}attach(t){this._attachedCamera=t;const e=this._attachedCamera.getScene();l.EasingFunction.setEasingMode(l.EasingMode),this._onPrePointerObservableObserver=e.onPrePointerObservable.add((t=>{t.type!==a.kD.POINTERDOWN?t.type===a.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onMeshTargetChangedObserver=t.onMeshTargetChangedObservable.add((t=>{t&&this.zoomOnMesh(t,void 0,(()=>{this.onTargetFramingAnimationEndObservable.notifyObservers()}))})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{this._applyUserInteraction(),this._maintainCameraAboveGround()}))}detach(){if(!this._attachedCamera)return;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}zoomOnMesh(t,e=!1,i=null){t.computeWorldMatrix(!0);const n=t.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(n.minimumWorld,n.maximumWorld,e,i)}zoomOnMeshHierarchy(t,e=!1,i=null){t.computeWorldMatrix(!0);const n=t.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(n.min,n.max,e,i)}zoomOnMeshesHierarchy(t,e=!1,i=null){const n=new r.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let e=0;e<t.length;e++){const i=t[e].getHierarchyBoundingVectors(!0);r.P.CheckExtends(i.min,n,s),r.P.CheckExtends(i.max,n,s)}this.zoomOnBoundingInfo(n,s,e,i)}zoomOnBoundingInfo(t,e,i=!1,n=null){let s;if(!this._attachedCamera)return;const a=t.y,o=a+(e.y-a)*this._positionScale,c=e.subtract(t).scale(.5);if(i)s=new r.P(0,o,0);else{const e=t.add(c);s=new r.P(e.x,o,e.z)}this._vectorTransition||(this._vectorTransition=h.f.CreateAnimation("target",h.f.ANIMATIONTYPE_VECTOR3,60,l.EasingFunction)),this._betaIsAnimating=!0;let u=h.f.TransitionTo("target",s,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);u&&this._animatables.push(u);let p=0;if(this._mode===l.FitFrustumSidesMode){const i=this._calculateLowerRadiusFromModelBoundingSphere(t,e);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=c.length()+this._attachedCamera.minZ),p=i}else this._mode===l.IgnoreBoundsSizeMode&&(p=this._calculateLowerRadiusFromModelBoundingSphere(t,e),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){const i=e.subtract(t).length();this._attachedCamera.panningSensibility=5e3/i,this._attachedCamera.wheelPrecision=100/p}this._radiusTransition||(this._radiusTransition=h.f.CreateAnimation("radius",h.f.ANIMATIONTYPE_FLOAT,60,l.EasingFunction)),u=h.f.TransitionTo("radius",p,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,(()=>{this.stopAllAnimations(),n&&n(),this._attachedCamera&&this._attachedCamera.useInputToRestoreState&&this._attachedCamera.storeState()})),u&&this._animatables.push(u)}_calculateLowerRadiusFromModelBoundingSphere(t,e){const i=e.subtract(t).length(),n=this._getFrustumSlope(),s=.5*i*this._radiusScale,a=s*Math.sqrt(1+1/(n.x*n.x)),o=s*Math.sqrt(1+1/(n.y*n.y));let r=Math.max(a,o);const h=this._attachedCamera;return h?(h.lowerRadiusLimit&&this._mode===l.IgnoreBoundsSizeMode&&(r=r<h.lowerRadiusLimit?h.lowerRadiusLimit:r),h.upperRadiusLimit&&(r=r>h.upperRadiusLimit?h.upperRadiusLimit:r),r):0}_maintainCameraAboveGround(){if(this._elevationReturnTime<0)return;const t=o.F.Now-this._lastInteractionTime,e=.5*Math.PI-this._defaultElevation,i=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>i&&t>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=h.f.CreateAnimation("beta",h.f.ANIMATIONTYPE_FLOAT,60,l.EasingFunction));const t=h.f.TransitionTo("beta",e,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,(()=>{this._clearAnimationLocks(),this.stopAllAnimations()}));t&&this._animatables.push(t)}}_getFrustumSlope(){const t=this._attachedCamera;if(!t)return r.FM.Zero();const e=t.getScene().getEngine().getAspectRatio(t),i=Math.tan(t.fov/2),n=i*e;return new r.FM(n,i)}_clearAnimationLocks(){this._betaIsAnimating=!1}_applyUserInteraction(){this.isUserIsMoving&&(this._lastInteractionTime=o.F.Now,this.stopAllAnimations(),this._clearAnimationLocks())}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()}get isUserIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}l.EasingFunction=new n.EI,l.EasingMode=n.Kp.EASINGMODE_EASEINOUT,l.IgnoreBoundsSizeMode=0,l.FitFrustumSidesMode=1},7632:(t,e,i)=>{i.d(e,{O:()=>r});var n=i(3555),s=i(6786),a=i(4651),o=i(147);class r{constructor(){this._currentActiveButton=-1,this.buttons=[0,1,2]}attachControl(t){t=a.w1.BackCompatCameraNoPreventDefault(arguments);const e=this.camera.getEngine(),i=e.getInputElement();let n=0,s=null;this._pointA=null,this._pointB=null,this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._pointerInput=a=>{var r,h;const l=a.event,c="touch"===l.pointerType;if(e.isInVRExclusivePointerMode)return;if(a.type!==o.kD.POINTERMOVE&&-1===this.buttons.indexOf(l.button))return;const u=l.target;if(this._altKey=l.altKey,this._ctrlKey=l.ctrlKey,this._metaKey=l.metaKey,this._shiftKey=l.shiftKey,this._buttonsPressed=l.buttons,e.isPointerLock){const t=l.movementX,e=l.movementY;this.onTouch(null,t,e),this._pointA=null,this._pointB=null}else{if(a.type!==o.kD.POINTERDOWN&&c&&(null===(r=this._pointA)||void 0===r?void 0:r.pointerId)!==l.pointerId&&(null===(h=this._pointB)||void 0===h?void 0:h.pointerId)!==l.pointerId)return;if(a.type!==o.kD.POINTERDOWN||-1!==this._currentActiveButton&&!c)if(a.type===o.kD.POINTERDOUBLETAP)this.onDoubleTap(l.pointerType);else if(a.type!==o.kD.POINTERUP||this._currentActiveButton!==l.button&&!c){if(a.type===o.kD.POINTERMOVE)if(t||l.preventDefault(),this._pointA&&null===this._pointB){const t=l.clientX-this._pointA.x,e=l.clientY-this._pointA.y;this.onTouch(this._pointA,t,e),this._pointA.x=l.clientX,this._pointA.y=l.clientY}else if(this._pointA&&this._pointB){const t=this._pointA.pointerId===l.pointerId?this._pointA:this._pointB;t.x=l.clientX,t.y=l.clientY;const e=this._pointA.x-this._pointB.x,i=this._pointA.y-this._pointB.y,o=e*e+i*i,r={x:(this._pointA.x+this._pointB.x)/2,y:(this._pointA.y+this._pointB.y)/2,pointerId:l.pointerId,type:a.type};this.onMultiTouch(this._pointA,this._pointB,n,o,s,r),s=r,n=o}}else{try{null==u||u.releasePointerCapture(l.pointerId)}catch(t){}c||(this._pointB=null),e._badOS?this._pointA=this._pointB=null:this._pointB&&this._pointA&&this._pointA.pointerId==l.pointerId?(this._pointA=this._pointB,this._pointB=null):this._pointA&&this._pointB&&this._pointB.pointerId==l.pointerId?this._pointB=null:this._pointA=this._pointB=null,(0!==n||s)&&(this.onMultiTouch(this._pointA,this._pointB,n,0,s,null),n=0,s=null),this._currentActiveButton=-1,this.onButtonUp(l),t||l.preventDefault()}else{try{null==u||u.setPointerCapture(l.pointerId)}catch(t){}if(null===this._pointA)this._pointA={x:l.clientX,y:l.clientY,pointerId:l.pointerId,type:l.pointerType};else{if(null!==this._pointB)return;this._pointB={x:l.clientX,y:l.clientY,pointerId:l.pointerId,type:l.pointerType}}-1!==this._currentActiveButton||c||(this._currentActiveButton=l.button),this.onButtonDown(l),t||(l.preventDefault(),i&&i.focus())}}},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,o.kD.POINTERDOWN|o.kD.POINTERUP|o.kD.POINTERMOVE|o.kD.POINTERDOUBLETAP),this._onLostFocus=()=>{this._pointA=this._pointB=null,n=0,s=null,this.onLostFocus()},this._contextMenuBind=this.onContextMenu.bind(this),i&&i.addEventListener("contextmenu",this._contextMenuBind,!1);const r=this.camera.getScene().getEngine().getHostWindow();r&&a.w1.RegisterTopRootEvents(r,[{name:"blur",handler:this._onLostFocus}])}detachControl(){if(this._onLostFocus){const t=this.camera.getScene().getEngine().getHostWindow();t&&a.w1.UnregisterTopRootEvents(t,[{name:"blur",handler:this._onLostFocus}])}if(this._observer){if(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._contextMenuBind){const t=this.camera.getScene().getEngine().getInputElement();t&&t.removeEventListener("contextmenu",this._contextMenuBind)}this._onLostFocus=null}this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._currentActiveButton=-1}getClassName(){return"BaseCameraPointersInput"}getSimpleName(){return"pointers"}onDoubleTap(t){}onTouch(t,e,i){}onMultiTouch(t,e,i,n,s,a){}onContextMenu(t){t.preventDefault()}onButtonDown(t){}onButtonUp(t){}onLostFocus(){}}(0,n.gn)([(0,s.qC)()],r.prototype,"buttons",void 0)},4452:(t,e,i)=>{i.d(e,{v:()=>h});var n=i(3555),s=i(6786),a=i(4442),o=i(6233),r=i(4651);class h{constructor(){this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}attachControl(t){t=r.w1.BackCompatCameraNoPreventDefault(arguments),this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add((()=>{this._keys.length=0})),this._onKeyboardObserver=this._scene.onKeyboardObservable.add((e=>{const i=e.event;if(!i.metaKey)if(e.type===o.OG.KEYDOWN)this._ctrlPressed=i.ctrlKey,this._altPressed=i.altKey,(-1!==this.keysUp.indexOf(i.keyCode)||-1!==this.keysDown.indexOf(i.keyCode)||-1!==this.keysLeft.indexOf(i.keyCode)||-1!==this.keysRight.indexOf(i.keyCode)||-1!==this.keysReset.indexOf(i.keyCode))&&(-1===this._keys.indexOf(i.keyCode)&&this._keys.push(i.keyCode),i.preventDefault&&(t||i.preventDefault()));else if(-1!==this.keysUp.indexOf(i.keyCode)||-1!==this.keysDown.indexOf(i.keyCode)||-1!==this.keysLeft.indexOf(i.keyCode)||-1!==this.keysRight.indexOf(i.keyCode)||-1!==this.keysReset.indexOf(i.keyCode)){const e=this._keys.indexOf(i.keyCode);e>=0&&this._keys.splice(e,1),i.preventDefault&&(t||i.preventDefault())}})))}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}checkInputs(){if(this._onKeyboardObserver){const t=this.camera;for(let e=0;e<this._keys.length;e++){const i=this._keys[e];-1!==this.keysLeft.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX-=1/this.panningSensibility:t.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset+=1/this.zoomingSensibility:t.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX+=1/this.panningSensibility:t.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset-=1/this.zoomingSensibility:t.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(i)&&t.useInputToRestoreState&&t.restoreState()}}}getClassName(){return"ArcRotateCameraKeyboardMoveInput"}getSimpleName(){return"keyboard"}}(0,n.gn)([(0,s.qC)()],h.prototype,"keysUp",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"keysDown",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"keysLeft",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"keysRight",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"keysReset",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"panningSensibility",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"zoomingSensibility",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"useAltToZoom",void 0),(0,n.gn)([(0,s.qC)()],h.prototype,"angularSpeed",void 0),a.u.ArcRotateCameraKeyboardMoveInput=h},7366:(t,e,i)=>{i.d(e,{F:()=>d});var n=i(3555),s=i(6786),a=i(4442),o=i(147),r=i(8329),h=i(972),l=i(7786),c=i(6485),u=i(1865),p=i(4651);class d{constructor(){this.wheelPrecision=3,this.zoomToMouseLocation=!1,this.wheelDeltaPercentage=0,this.customComputeDeltaFromMouseWheel=null,this._inertialPanning=h.P.Zero()}_computeDeltaFromMouseWheelLegacyEvent(t,e){let i=0;const n=.01*t*this.wheelDeltaPercentage*e;return i=t>0?n/(1+this.wheelDeltaPercentage):n*(1+this.wheelDeltaPercentage),i}attachControl(t){t=p.w1.BackCompatCameraNoPreventDefault(arguments),this._wheel=e=>{if(e.type!==o.kD.POINTERWHEEL)return;const i=e.event;let n=0;const s=i.deltaMode===c.G.DOM_DELTA_LINE?40:1,a=-i.deltaY*s;if(this.customComputeDeltaFromMouseWheel)n=this.customComputeDeltaFromMouseWheel(a,this,i);else if(this.wheelDeltaPercentage){if(n=this._computeDeltaFromMouseWheelLegacyEvent(a,this.camera.radius),n>0){let t=this.camera.radius,e=this.camera.inertialRadiusOffset+n;for(let i=0;i<20&&Math.abs(e)>.001;i++)t-=e,e*=this.camera.inertia;t=u.R.Clamp(t,0,Number.MAX_VALUE),n=this._computeDeltaFromMouseWheelLegacyEvent(a,t)}}else n=a/(40*this.wheelPrecision);n&&(this.zoomToMouseLocation?(this._hitPlane||this._updateHitPlane(),this._zoomToMouse(n)):this.camera.inertialRadiusOffset+=n),i.preventDefault&&(t||i.preventDefault())},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._wheel,o.kD.POINTERWHEEL),this.zoomToMouseLocation&&this._inertialPanning.setAll(0)}detachControl(){this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._wheel=null)}checkInputs(){if(!this.zoomToMouseLocation)return;const t=this.camera;0+t.inertialAlphaOffset+t.inertialBetaOffset+t.inertialRadiusOffset&&(this._updateHitPlane(),t.target.addInPlace(this._inertialPanning),this._inertialPanning.scaleInPlace(t.inertia),this._zeroIfClose(this._inertialPanning))}getClassName(){return"ArcRotateCameraMouseWheelInput"}getSimpleName(){return"mousewheel"}_updateHitPlane(){const t=this.camera,e=t.target.subtract(t.position);this._hitPlane=r.J.FromPositionAndNormal(t.target,e)}_getPosition(){var t;const e=this.camera,i=e.getScene(),n=i.createPickingRay(i.pointerX,i.pointerY,h.y3.Identity(),e,!1);n.origin.x-=e.targetScreenOffset.x,n.origin.y-=e.targetScreenOffset.y;let s=0;return this._hitPlane&&(s=null!==(t=n.intersectsPlane(this._hitPlane))&&void 0!==t?t:0),n.origin.addInPlace(n.direction.scaleInPlace(s))}_zoomToMouse(t){var e,i;const n=this.camera,s=1-n.inertia;if(n.lowerRadiusLimit){const i=null!==(e=n.lowerRadiusLimit)&&void 0!==e?e:0;n.radius-(n.inertialRadiusOffset+t)/s<i&&(t=(n.radius-i)*s-n.inertialRadiusOffset)}if(n.upperRadiusLimit){const e=null!==(i=n.upperRadiusLimit)&&void 0!==i?i:0;n.radius-(n.inertialRadiusOffset+t)/s>e&&(t=(n.radius-e)*s-n.inertialRadiusOffset)}const a=t/s/n.radius,o=this._getPosition(),r=h.jp.Vector3[6];o.subtractToRef(n.target,r),r.scaleInPlace(a),r.scaleInPlace(s),this._inertialPanning.addInPlace(r),n.inertialRadiusOffset+=t}_zeroIfClose(t){Math.abs(t.x)<l.kn&&(t.x=0),Math.abs(t.y)<l.kn&&(t.y=0),Math.abs(t.z)<l.kn&&(t.z=0)}}(0,n.gn)([(0,s.qC)()],d.prototype,"wheelPrecision",void 0),(0,n.gn)([(0,s.qC)()],d.prototype,"zoomToMouseLocation",void 0),(0,n.gn)([(0,s.qC)()],d.prototype,"wheelDeltaPercentage",void 0),a.u.ArcRotateCameraMouseWheelInput=d},5630:(t,e,i)=>{i.d(e,{H:()=>r});var n=i(3555),s=i(6786),a=i(4442),o=i(7632);class r extends o.O{constructor(){super(...arguments),this.buttons=[0,1,2],this.angularSensibilityX=1e3,this.angularSensibilityY=1e3,this.pinchPrecision=12,this.pinchDeltaPercentage=0,this.useNaturalPinchZoom=!1,this.pinchZoom=!0,this.panningSensibility=1e3,this.multiTouchPanning=!0,this.multiTouchPanAndZoom=!0,this.pinchInwards=!0,this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}getClassName(){return"ArcRotateCameraPointersInput"}_computeMultiTouchPanning(t,e){if(0!==this.panningSensibility&&t&&e){const i=e.x-t.x,n=e.y-t.y;this.camera.inertialPanningX+=-i/this.panningSensibility,this.camera.inertialPanningY+=n/this.panningSensibility}}_computePinchZoom(t,e){const i=this.camera.radius||r.MinimumRadiusForPinch;this.useNaturalPinchZoom?this.camera.radius=i*Math.sqrt(t)/Math.sqrt(e):this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=.001*(e-t)*i*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(e-t)/(this.pinchPrecision*(this.pinchInwards?1:-1)*(this.angularSensibilityX+this.angularSensibilityY)/2)}onTouch(t,e,i){0!==this.panningSensibility&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-e/this.panningSensibility,this.camera.inertialPanningY+=i/this.panningSensibility):(this.camera.inertialAlphaOffset-=e/this.angularSensibilityX,this.camera.inertialBetaOffset-=i/this.angularSensibilityY)}onDoubleTap(){this.camera.useInputToRestoreState&&this.camera.restoreState()}onMultiTouch(t,e,i,n,s,a){0===i&&null===s||0===n&&null===a||(this.multiTouchPanAndZoom?(this._computePinchZoom(i,n),this._computeMultiTouchPanning(s,a)):this.multiTouchPanning&&this.pinchZoom?(this._twoFingerActivityCount++,this._isPinching||this._twoFingerActivityCount<20&&Math.abs(Math.sqrt(n)-Math.sqrt(i))>this.camera.pinchToPanMaxDistance?(this._computePinchZoom(i,n),this._isPinching=!0):this._computeMultiTouchPanning(s,a)):this.multiTouchPanning?this._computeMultiTouchPanning(s,a):this.pinchZoom&&this._computePinchZoom(i,n))}onButtonDown(t){this._isPanClick=t.button===this.camera._panningMouseButton}onButtonUp(){this._twoFingerActivityCount=0,this._isPinching=!1}onLostFocus(){this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}}r.MinimumRadiusForPinch=.001,(0,n.gn)([(0,s.qC)()],r.prototype,"buttons",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"angularSensibilityX",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"angularSensibilityY",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"pinchPrecision",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"pinchDeltaPercentage",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"useNaturalPinchZoom",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"pinchZoom",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"panningSensibility",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"multiTouchPanning",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"multiTouchPanAndZoom",void 0),a.u.ArcRotateCameraPointersInput=r},3579:(t,e,i)=>{i.d(e,{Y:()=>f});var n=i(3555),s=i(6786),a=i(4673),o=i(972),r=i(2528),h=i(3632),l=i(1480),c=i(3425),u=i(1193),p=i(5593),d=i(5753),_=i(4946),m=i(7786),g=i(4651);r.N.AddNodeConstructor("ArcRotateCamera",((t,e)=>()=>new f(t,0,0,1,o.P.Zero(),e)));class f extends d.C{get target(){return this._target}set target(t){this.setTarget(t)}get targetHost(){return this._targetHost}set targetHost(t){t&&this.setTarget(t)}getTarget(){return this.target}get position(){return this._position}set position(t){this.setPosition(t)}set upVector(t){this._upToYMatrix||(this._yToUpMatrix=new o.y3,this._upToYMatrix=new o.y3,this._upVector=o.P.Zero()),t.normalize(),this._upVector.copyFrom(t),this.setMatUp()}get upVector(){return this._upVector}setMatUp(){o.y3.RotationAlignToRef(o.P.UpReadOnly,this._upVector,this._yToUpMatrix),o.y3.RotationAlignToRef(this._upVector,o.P.UpReadOnly,this._upToYMatrix)}get angularSensibilityX(){const t=this.inputs.attached.pointers;return t?t.angularSensibilityX:0}set angularSensibilityX(t){const e=this.inputs.attached.pointers;e&&(e.angularSensibilityX=t)}get angularSensibilityY(){const t=this.inputs.attached.pointers;return t?t.angularSensibilityY:0}set angularSensibilityY(t){const e=this.inputs.attached.pointers;e&&(e.angularSensibilityY=t)}get pinchPrecision(){const t=this.inputs.attached.pointers;return t?t.pinchPrecision:0}set pinchPrecision(t){const e=this.inputs.attached.pointers;e&&(e.pinchPrecision=t)}get pinchDeltaPercentage(){const t=this.inputs.attached.pointers;return t?t.pinchDeltaPercentage:0}set pinchDeltaPercentage(t){const e=this.inputs.attached.pointers;e&&(e.pinchDeltaPercentage=t)}get useNaturalPinchZoom(){const t=this.inputs.attached.pointers;return!!t&&t.useNaturalPinchZoom}set useNaturalPinchZoom(t){const e=this.inputs.attached.pointers;e&&(e.useNaturalPinchZoom=t)}get panningSensibility(){const t=this.inputs.attached.pointers;return t?t.panningSensibility:0}set panningSensibility(t){const e=this.inputs.attached.pointers;e&&(e.panningSensibility=t)}get keysUp(){const t=this.inputs.attached.keyboard;return t?t.keysUp:[]}set keysUp(t){const e=this.inputs.attached.keyboard;e&&(e.keysUp=t)}get keysDown(){const t=this.inputs.attached.keyboard;return t?t.keysDown:[]}set keysDown(t){const e=this.inputs.attached.keyboard;e&&(e.keysDown=t)}get keysLeft(){const t=this.inputs.attached.keyboard;return t?t.keysLeft:[]}set keysLeft(t){const e=this.inputs.attached.keyboard;e&&(e.keysLeft=t)}get keysRight(){const t=this.inputs.attached.keyboard;return t?t.keysRight:[]}set keysRight(t){const e=this.inputs.attached.keyboard;e&&(e.keysRight=t)}get wheelPrecision(){const t=this.inputs.attached.mousewheel;return t?t.wheelPrecision:0}set wheelPrecision(t){const e=this.inputs.attached.mousewheel;e&&(e.wheelPrecision=t)}get zoomToMouseLocation(){const t=this.inputs.attached.mousewheel;return!!t&&t.zoomToMouseLocation}set zoomToMouseLocation(t){const e=this.inputs.attached.mousewheel;e&&(e.zoomToMouseLocation=t)}get wheelDeltaPercentage(){const t=this.inputs.attached.mousewheel;return t?t.wheelDeltaPercentage:0}set wheelDeltaPercentage(t){const e=this.inputs.attached.mousewheel;e&&(e.wheelDeltaPercentage=t)}get bouncingBehavior(){return this._bouncingBehavior}get useBouncingBehavior(){return null!=this._bouncingBehavior}set useBouncingBehavior(t){t!==this.useBouncingBehavior&&(t?(this._bouncingBehavior=new c.r,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))}get framingBehavior(){return this._framingBehavior}get useFramingBehavior(){return null!=this._framingBehavior}set useFramingBehavior(t){t!==this.useFramingBehavior&&(t?(this._framingBehavior=new u.d,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))}get autoRotationBehavior(){return this._autoRotationBehavior}get useAutoRotationBehavior(){return null!=this._autoRotationBehavior}set useAutoRotationBehavior(t){t!==this.useAutoRotationBehavior&&(t?(this._autoRotationBehavior=new l.o,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))}constructor(t,e,i,n,s,r,h=!0){super(t,o.P.Zero(),r,h),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.lowerAlphaLimit=null,this.upperAlphaLimit=null,this.lowerBetaLimit=.01,this.upperBetaLimit=Math.PI-.01,this.lowerRadiusLimit=null,this.upperRadiusLimit=null,this.inertialPanningX=0,this.inertialPanningY=0,this.pinchToPanMaxDistance=20,this.panningDistanceLimit=null,this.panningOriginTarget=o.P.Zero(),this.panningInertia=.9,this.zoomOnFactor=1,this.targetScreenOffset=o.FM.Zero(),this.allowUpsideDown=!0,this.useInputToRestoreState=!0,this._viewMatrix=new o.y3,this.panningAxis=new o.P(1,1,0),this._transformedDirection=new o.P,this.mapPanning=!1,this.onMeshTargetChangedObservable=new a.y$,this.checkCollisions=!1,this.collisionRadius=new o.P(.5,.5,.5),this._previousPosition=o.P.Zero(),this._collisionVelocity=o.P.Zero(),this._newPosition=o.P.Zero(),this._computationVector=o.P.Zero(),this._onCollisionPositionChange=(t,e,i=null)=>{i?(this.setPosition(e),this.onCollide&&this.onCollide(i)):this._previousPosition.copyFrom(this._position);const n=Math.cos(this.alpha),s=Math.sin(this.alpha),a=Math.cos(this.beta);let o=Math.sin(this.beta);0===o&&(o=1e-4);const r=this._getTargetPosition();this._computationVector.copyFromFloats(this.radius*n*o,this.radius*a,this.radius*s*o),r.addToRef(this._computationVector,this._newPosition),this._position.copyFrom(this._newPosition);let h=this.upVector;this.allowUpsideDown&&this.beta<0&&(h=h.clone(),h=h.negate()),this._computeViewMatrix(this._position,r,h),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y),this._collisionTriggered=!1},this._target=o.P.Zero(),s&&this.setTarget(s),this.alpha=e,this.beta=i,this.radius=n,this.getViewMatrix(),this.inputs=new _.$(this),this.inputs.addKeyboard().addMouseWheel().addPointers()}_initCache(){super._initCache(),this._cache._target=new o.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=o.FM.Zero()}_updateCache(t){t||super._updateCache(),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)}_getTargetPosition(){if(this._targetHost&&this._targetHost.getAbsolutePosition){const t=this._targetHost.getAbsolutePosition();this._targetBoundingCenter?t.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(t)}return this._getLockedTargetPosition()||this._target}storeState(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),this._storedTargetScreenOffset=this.targetScreenOffset.clone(),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.setTarget(this._storedTarget.clone()),this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.targetScreenOffset=this._storedTargetScreenOffset.clone(),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0)}_isSynchronizedViewMatrix(){return!!super._isSynchronizedViewMatrix()&&this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset)}attachControl(t,e,i=!0,n=2){const s=arguments;e=g.w1.BackCompatCameraNoPreventDefault(s),this._useCtrlForPanning=i,this._panningMouseButton=n,"boolean"==typeof s[0]&&(s.length>1&&(this._useCtrlForPanning=s[1]),s.length>2&&(this._panningMouseButton=s[2])),this.inputs.attachElement(e),this._reset=()=>{this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0}}detachControl(){this.inputs.detachElement(),this._reset&&this._reset()}_checkInputs(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){const t=this.invertRotation?-1:1;let e=this.inertialAlphaOffset;this.beta<=0&&(e*=-1),this.getScene().useRightHandedSystem&&(e*=-1),this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(e*=-1),this.alpha+=e*t,this.beta+=this.inertialBetaOffset*t,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<m.kn&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<m.kn&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*m.kn&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY){const t=new o.P(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY);this._viewMatrix.invertToRef(this._cameraTransformMatrix),t.multiplyInPlace(this.panningAxis),o.P.TransformNormalToRef(t,this._cameraTransformMatrix,this._transformedDirection),!this.mapPanning&&this.panningAxis.y||(this._transformedDirection.y=0),this._targetHost||(this.panningDistanceLimit?(this._transformedDirection.addInPlace(this._target),o.P.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection)):this._target.addInPlace(this._transformedDirection)),this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*m.kn&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*m.kn&&(this.inertialPanningY=0)}this._checkLimits(),super._checkInputs()}}_checkLimits(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)}rebuildAnglesAndRadius(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||o.P.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector),this.radius=this._computationVector.length(),0===this.radius&&(this.radius=1e-4);const t=this.alpha;0===this._computationVector.x&&0===this._computationVector.z?this.alpha=Math.PI/2:this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha);const e=Math.round((t-this.alpha)/(2*Math.PI));this.alpha+=2*e*Math.PI,this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()}setPosition(t){this._position.equals(t)||(this._position.copyFrom(t),this.rebuildAnglesAndRadius())}setTarget(t,e=!1,i=!1,n=!1){var s;if(n=null!==(s=this.overrideCloneAlphaBetaRadius)&&void 0!==s?s:n,t.getBoundingInfo)this._targetBoundingCenter=e?t.getBoundingInfo().boundingBox.centerWorld.clone():null,t.computeWorldMatrix(),this._targetHost=t,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{const e=t,n=this._getTargetPosition();if(n&&!i&&n.equals(e))return;this._targetHost=null,this._target=e,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}n||this.rebuildAnglesAndRadius()}_getViewMatrix(){const t=Math.cos(this.alpha),e=Math.sin(this.alpha),i=Math.cos(this.beta);let n=Math.sin(this.beta);0===n&&(n=1e-4),0===this.radius&&(this.radius=1e-4);const s=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*t*n,this.radius*i,this.radius*e*n),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||o.P.TransformCoordinatesToRef(this._computationVector,this._yToUpMatrix,this._computationVector),s.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions){const t=this.getScene().collisionCoordinator;this._collider||(this._collider=t.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,t.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}else{this._position.copyFrom(this._newPosition);let t=this.upVector;this.allowUpsideDown&&n<0&&(t=t.negate()),this._computeViewMatrix(this._position,s,t),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=s,this._viewMatrix}zoomOn(t,e=!1){t=t||this.getScene().meshes;const i=h.Kj.MinMax(t),n=o.P.Distance(i.min,i.max);this.radius=n*this.zoomOnFactor,this.focusOn({min:i.min,max:i.max,distance:n},e)}focusOn(t,e=!1){let i,n;if(void 0===t.min){const e=t||this.getScene().meshes;i=h.Kj.MinMax(e),n=o.P.Distance(i.min,i.max)}else i=t,n=t.distance;this._target=h.Kj.Center(i),e||(this.maxZ=2*n)}createRigCamera(t,e){let i=0;switch(this.cameraRigMode){case p.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case p.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case p.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case p.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case p.V.RIG_MODE_VR:i=this._cameraRigParams.stereoHalfAngle*(0===e?1:-1);break;case p.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:i=this._cameraRigParams.stereoHalfAngle*(0===e?-1:1)}const n=new f(t,this.alpha+i,this.beta,this.radius,this._target,this.getScene());return n._cameraRigParams={},n.isRigCamera=!0,n.rigParent=this,n.upVector=this.upVector,n.mode=this.mode,n.orthoLeft=this.orthoLeft,n.orthoRight=this.orthoRight,n.orthoBottom=this.orthoBottom,n.orthoTop=this.orthoTop,n}_updateRigCameras(){const t=this._rigCameras[0],e=this._rigCameras[1];switch(t.beta=e.beta=this.beta,this.cameraRigMode){case p.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case p.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case p.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case p.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case p.V.RIG_MODE_VR:t.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,e.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case p.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:t.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,e.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}super._updateRigCameras()}dispose(){this.inputs.clear(),super.dispose()}getClassName(){return"ArcRotateCamera"}}(0,n.gn)([(0,s.qC)()],f.prototype,"alpha",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"beta",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"radius",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"overrideCloneAlphaBetaRadius",void 0),(0,n.gn)([(0,s.hd)("target")],f.prototype,"_target",void 0),(0,n.gn)([(0,s.RR)("targetHost")],f.prototype,"_targetHost",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"inertialAlphaOffset",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"inertialBetaOffset",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"inertialRadiusOffset",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"lowerAlphaLimit",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"upperAlphaLimit",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"lowerBetaLimit",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"upperBetaLimit",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"lowerRadiusLimit",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"upperRadiusLimit",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"inertialPanningX",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"inertialPanningY",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"pinchToPanMaxDistance",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"panningDistanceLimit",void 0),(0,n.gn)([(0,s.hd)()],f.prototype,"panningOriginTarget",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"panningInertia",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"zoomToMouseLocation",null),(0,n.gn)([(0,s.qC)()],f.prototype,"zoomOnFactor",void 0),(0,n.gn)([(0,s.QC)()],f.prototype,"targetScreenOffset",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"allowUpsideDown",void 0),(0,n.gn)([(0,s.qC)()],f.prototype,"useInputToRestoreState",void 0)},4946:(t,e,i)=>{i.d(e,{$:()=>r});var n=i(5630),s=i(4452),a=i(7366),o=i(4442);class r extends o.p{constructor(t){super(t)}addMouseWheel(){return this.add(new a.F),this}addPointers(){return this.add(new n.H),this}addKeyboard(){return this.add(new s.v),this}}}}]);
//# sourceMappingURL=579.babylonBundle.js.map