"use strict";(self.webpackChunkbabylonjs_typescript_webpack_template=self.webpackChunkbabylonjs_typescript_webpack_template||[]).push([[463],{15423:(e,t,n)=>{n.r(t),n.d(t,{DefaultSceneWithTexture:()=>b,default:()=>w});var o=n(8714),s=n(23579),r=n(90972),i=n(30307),a=n(39268),l=n(73354),c=n(84684),d=n(81552),u=n(63789),p=n(6070),h=n(14404);n(51723);const g=n.p+"628b10094e62129397fc4859ae7349d6.stl";var m=n(58474);class b{constructor(){this.createScene=async(e,t)=>{const b=new o.x(e);Promise.all([Promise.resolve().then(n.bind(n,31568)),Promise.all([n.e(913),n.e(596)]).then(n.t.bind(n,53596,23))]).then((e=>{console.log(e),b.debugLayer.show({handleResize:!0,overlay:!0,globalRoot:document.getElementById("#root")||void 0})})),h.a.DO_NOT_ALTER_FILE_COORDINATES=!0;const w=(await l.SceneLoader.ImportMeshAsync("","",g,b,void 0,".stl")).meshes[0],f=(await l.SceneLoader.ImportMeshAsync("","",g,b,void 0,".stl")).meshes[0],y=(await l.SceneLoader.ImportMeshAsync("","",g,b,void 0,".stl")).meshes[0];y.name="MoveableVisible",y.visibility=1;const P=(await l.SceneLoader.ImportMeshAsync("","",g,b,void 0,".stl")).meshes[0];P.name="MoveableHidden",P.visibility=1;const x=new l.Mesh("NagelPunkte",b);x.parent=P,w.position=new r.P(0,0,0),y.rotationQuaternion=r._f.FromEulerVector(new r.P(Math.PI/2,Math.PI,0)),y.scaling=new r.P(.01,.01,.01),w.scaling=new r.P(.01,.01,.01);const S=function(e){const t=new l.TransformNode("CenterNode",e.getScene()),n=e.getBoundingInfo().boundingBox.center.clone(),o=n.scaleInPlace(-1);return e.position.addInPlace(o),t.position=n,e.setPivotMatrix(r.y3.Identity()),t}(P);P.getBoundingInfo().boundingBox,P.parent=S,S.rotationQuaternion=r._f.FromEulerVector(new r.P(Math.PI/2,Math.PI,0)),S.position=new r.P(59.047,.126,-10.105);const C=async function(e){try{const e=await fetch("https://raw.githubusercontent.com/P-Miha/Kyros-Zylinder/master/assets/SDFInformation/Nagel1.sdf");return await e.text()}catch(e){throw console.error("Fehler beim Laden der SDF-Datei:",e),e}}(),A=function(e){const t=e.trim().split("\n"),n={bbox:{min:l.Vector3.Zero(),max:l.Vector3.Zero()},cellSize:0,res:l.Vector3.Zero(),numCells:0,distances:[]};for(let e=0;e<t.length;e++){const o=t[e].trim(),s=o.indexOf("#");if(-1!==s){const t=o.substring(0,s).trim();if(0===t.length)continue;const r=t.split(" ").map(parseFloat);r.length>0&&(0===e?n.bbox.min=l.Vector3.FromArray(r):1===e?n.bbox.max=l.Vector3.FromArray(r):2===e?n.cellSize=r[0]:3===e?n.res=l.Vector3.FromArray(r):4===e?n.numCells=r[0]:n.distances.push(...r))}else{const t=o.split(" ").map(parseFloat);t.length>0&&(0===e?n.bbox.min=l.Vector3.FromArray(t):1===e?n.bbox.max=l.Vector3.FromArray(t):2===e?n.cellSize=t[0]:3===e?n.res=l.Vector3.FromArray(t):4===e?n.numCells=t[0]:n.distances.push(...t))}}return n}(await C),M=new l.Mesh("boundingBox",b);M.setBoundingInfo(new l.BoundingInfo(A.bbox.min,A.bbox.max)),M.showBoundingBox=!0;const v=new s.Y("my first camera",0,Math.PI/3,10,new r.P(0,0,0),b);v.alpha=4.735,v.beta=1.284,v.inertia=.01,v.attachControl(t,!0);const E=(0,i.$6)("ground",{width:6,height:6},b);E.position.y=-.5;const I=new a.K("ground material",b);I.diffuseTexture=new c.x(d.Z,b),E.material=I,E.receiveShadows=!0;const O=new u.O("light",new r.P(0,-1,1),b);O.intensity=.5,O.position.y=10;const _=new p.u(512,O);_.useBlurExponentialShadowMap=!0,_.blurScale=2,_.setDarkness(.2);const R=new a.K("collisionMaterial",b);R.diffuseColor=new l.Color3(1,0,0),new a.K("noCollisionMaterial",b).diffuseColor=new l.Color3(0,1,0),x.getChildMeshes();const T=m.AdvancedDynamicTexture.CreateFullscreenUI("UI"),F=m.Button.CreateSimpleButton("toggleCollisionCorrection","Toggle Collision Correction");F.width="150px",F.height="40px",F.background="red",F.color="white",F.left="35%",F.top="-45%";let B=!1;F.onPointerClickObservable.add((()=>{B=!B,F.background=B?"green":"red"})),T.addControl(F);const N=await b.createDefaultXRExperienceAsync({floorMeshes:[E]});N.baseExperience.sessionManager.session,N.baseExperience.camera.position=new r.P(0,0,0);let D=null,V=null,G=!1;N.input.onControllerAddedObservable.add((e=>{"right"===e.inputSource.handedness&&e.onMotionControllerInitObservable.add((()=>{const t=e.motionController?.getComponent("xr-standard-trigger");P.isVisible=!1,f.isVisible=!1,t&&t.onButtonStateChangedObservable.add((e=>{e.value>.5?G=!0:(G=!1,D=null,V=null)}))}))}));let k=!1;const Q=new Worker(new URL(n.p+n.u(413),n.b)),L=e.getFps();console.log("FPS: ",L);let j=0,z=0;return b.onBeforeRenderObservable.add((()=>{z++;const t=e.getFps();if(G){const e=N.input.controllers.find((e=>"right"===e.inputSource.handedness));if(e&&e.grip&&e.grip.position&&e.grip.rotationQuaternion){const t=e.grip.absolutePosition,n=e.grip.rotationQuaternion;if(t&&n&&D&&V){const o=new l.TransformNode("xrTransformNode",b);o.position=P.getBoundingInfo().boundingBox.centerWorld,o.rotationQuaternion=new r._f(0,0,0,0),o.rotationQuaternion=e.grip.rotationQuaternion,r._f.Identity().multiply(n).multiply(V.conjugate());const s=t.subtract(D);let i=V.conjugate().multiply(n);i=i.invert(),S.setParent(o),S.position=S.position.addInPlace(s.scaleInPlace(50)),o.rotationQuaternion=o.rotationQuaternion.multiply(i.conjugate()),y.position=P.absolutePosition.multiply(y.scaling),S.setParent(null),o.dispose()}D=t.clone(),V=n.clone()}}if(k=function(e){return e&&(j++,j>720&&(console.log("Worker Message lost, sending new Message"),e=!1,j=0)),e||(j=0),e}(k),!k&&t/50<z){z=0;const e=f.getWorldMatrix(),t=P.getWorldMatrix();Q.postMessage([t.asArray(),e.asArray()]),k=!0}y.position=P.absolutePosition.multiply(y.scaling),y.rotationQuaternion=S.rotationQuaternion,y.scaling=new r.P(.01,.01,.01),w.scaling=new r.P(.01,.01,.01),P.scaling=new r.P(1,1,1),f.scaling=new r.P(1,1,1),S.scaling=new r.P(1,1,1)})),Q.onmessage=e=>{const t=e.data[2];if(1!==t&&-1!==t||(k=!1),B&&1===t){const t=r.P.FromArray(e.data[0]),n=r._f.FromArray(e.data[1]),o=S.position;P.material=R;const s=o.add(t);S.position=s,S.rotationQuaternion=S.rotationQuaternion.add(n)}},b}}}const w=new b},81552:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"9b31293ea96c8dfa518b45622da82a13.jpg"},51723:(e,t,n)=>{n.d(t,{w:()=>i});var o=n(6070),s=n(66089),r=n(84686);n(64863).p.AddParser(r.l.NAME_SHADOWGENERATOR,((e,t)=>{if(void 0!==e.shadowGenerators&&null!==e.shadowGenerators)for(let n=0,r=e.shadowGenerators.length;n<r;n++){const r=e.shadowGenerators[n];r.className===s.R.CLASSNAME?s.R.Parse(r,t):o.u.Parse(r,t)}}));class i{constructor(e){this.name=r.l.NAME_SHADOWGENERATOR,this.scene=e}register(){this.scene._gatherRenderTargetsStage.registerStep(r.l.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR,this,this._gatherRenderTargets)}rebuild(){}serialize(e){e.shadowGenerators=[];const t=this.scene.lights;for(const n of t){const t=n.getShadowGenerators();if(t){const n=t.values();for(let t=n.next();!0!==t.done;t=n.next()){const n=t.value;e.shadowGenerators.push(n.serialize())}}}}addFromContainer(e){}removeFromContainer(e,t){}dispose(){}_gatherRenderTargets(e){const t=this.scene;if(this.scene.shadowsEnabled)for(let n=0;n<t.lights.length;n++){const o=t.lights[n],s=o.getShadowGenerators();if(o.isEnabled()&&o.shadowEnabled&&s){const n=s.values();for(let o=n.next();!0!==o.done;o=n.next()){const n=o.value.getShadowMap();-1!==t.textures.indexOf(n)&&e.push(n)}}}}}o.u._SceneComponentInitialization=e=>{let t=e._getComponent(r.l.NAME_SHADOWGENERATOR);t||(t=new i(e),e._addComponent(t))}},16765:(e,t,n)=>{n.d(t,{A1:()=>c,Qk:()=>l,jY:()=>a});var o=n(90972),s=n(33632),r=n(74517),i=n(53027);function a(e){const t=0|(e.segments||32),n=e.diameterX||e.diameter||1,s=e.diameterY||e.diameter||1,a=e.diameterZ||e.diameter||1,l=e.arc&&(e.arc<=0||e.arc>1)?1:e.arc||1,c=e.slice&&e.slice<=0?1:e.slice||1,d=0===e.sideOrientation?0:e.sideOrientation||r.x.DEFAULTSIDE,u=!!e.dedupTopBottomIndices,p=new o.P(n/2,s/2,a/2),h=2+t,g=2*h,m=[],b=[],w=[],f=[];for(let e=0;e<=h;e++){const t=e/h,n=t*Math.PI*c;for(let e=0;e<=g;e++){const s=e/g,r=s*Math.PI*2*l,a=o.y3.RotationZ(-n),c=o.y3.RotationY(r),d=o.P.TransformCoordinates(o.P.Up(),a),u=o.P.TransformCoordinates(d,c),h=u.multiply(p),m=u.divide(p).normalize();b.push(h.x,h.y,h.z),w.push(m.x,m.y,m.z),f.push(s,i.e.UseOpenGLOrientationForUV?1-t:t)}if(e>0){const t=b.length/3;for(let n=t-2*(g+1);n+g+2<t;n++)u?(e>1&&(m.push(n),m.push(n+1),m.push(n+g+1)),(e<h||c<1)&&(m.push(n+g+1),m.push(n+1),m.push(n+g+2))):(m.push(n),m.push(n+1),m.push(n+g+1),m.push(n+g+1),m.push(n+1),m.push(n+g+2))}}r.x._ComputeSides(d,b,m,w,f,e.frontUVs,e.backUVs);const y=new r.x;return y.indices=m,y.positions=b,y.normals=w,y.uvs=f,y}function l(e,t={},n=null){const o=new s.Kj(e,n);return t.sideOrientation=s.Kj._GetDefaultSideOrientation(t.sideOrientation),o._originalBuilderSideOrientation=t.sideOrientation,a(t).applyToMesh(o,t.updatable),o}const c={CreateSphere:l};r.x.CreateSphere=a,s.Kj.CreateSphere=(e,t,n,o,s,r)=>l(e,{segments:t,diameterX:n,diameterY:n,diameterZ:n,sideOrientation:r,updatable:s},o)}}]);
//# sourceMappingURL=463.babylonBundle.js.map